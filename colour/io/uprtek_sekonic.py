# -*- coding: utf-8 -*-
"""
UPRTek and Sekonic Data Input
=================

Defines the input object for *UPRTek* and *Sekonic* CSV spectral data files.
-   :class:`colour.io.SpectralDistribution_UPRTek`
-   :class:`colour.io.SpectralDistribution_Sekonic`
"""

import csv
import json
import os
import re
from collections import defaultdict

from colour.io import SpectralDistribution_IESTM2714
from colour.utilities import as_float_array, is_string


class SpectralDistribution_UPRTek(SpectralDistribution_IESTM2714):
    """
    This class serves as a parser to read and write *IES TM-27-14*
    spectral data XML file from a *UPRTek* CSV file.

    Parameters
    ----------
    path : unicode
        Path for UPRTek CSV file.

    Methods
    -------
    -   :meth:`~colour.SpectralDistribution_UPRTek.__init__`
    -   :meth:`~colour.SpectralDistribution_UPRTek.read`
    -   :meth:`~colour.SpectralDistribution_UPRTek.write`

    Examples
    --------
    >>> from os.path import dirname, join
    >>> directory = join(dirname(__file__), 'tests', 'resources')
    >>> sd = SpectralDistribution_UPRTek(join(directory, 'uprtek.xls.txt'))
    >>> print(sd.read())
    [[  3.80000000e+02   3.02670000e-02]
     [  3.81000000e+02   3.02670000e-02]
     [  3.82000000e+02   3.02670000e-02]
     [  3.83000000e+02   2.98220000e-02]
     [  3.84000000e+02   2.89780000e-02]
     [  3.85000000e+02   2.86230000e-02]
     [  3.86000000e+02   3.08450000e-02]
     [  3.87000000e+02   3.55960000e-02]
     [  3.88000000e+02   3.92310000e-02]
     [  3.89000000e+02   3.90640000e-02]
     [  3.90000000e+02   3.52230000e-02]
     [  3.91000000e+02   3.15800000e-02]
     [  3.92000000e+02   2.91810000e-02]
     [  3.93000000e+02   2.78080000e-02]
     [  3.94000000e+02   2.62560000e-02]
     [  3.95000000e+02   2.45260000e-02]
     [  3.96000000e+02   2.25570000e-02]
     [  3.97000000e+02   2.04190000e-02]
     [  3.98000000e+02   1.85210000e-02]
     [  3.99000000e+02   1.81490000e-02]
     [  4.00000000e+02   1.93250000e-02]
     [  4.01000000e+02   2.16660000e-02]
     [  4.02000000e+02   2.40450000e-02]
     [  4.03000000e+02   2.64730000e-02]
     [  4.04000000e+02   2.90760000e-02]
     [  4.05000000e+02   3.18400000e-02]
     [  4.06000000e+02   3.38840000e-02]
     [  4.07000000e+02   3.40380000e-02]
     [  4.08000000e+02   3.23020000e-02]
     [  4.09000000e+02   3.03830000e-02]
     [  4.10000000e+02   2.94260000e-02]
     [  4.11000000e+02   2.99790000e-02]
     [  4.12000000e+02   3.26140000e-02]
     [  4.13000000e+02   3.72040000e-02]
     [  4.14000000e+02   4.22790000e-02]
     [  4.15000000e+02   4.60290000e-02]
     [  4.16000000e+02   4.86980000e-02]
     [  4.17000000e+02   5.30640000e-02]
     [  4.18000000e+02   5.95300000e-02]
     [  4.19000000e+02   7.08400000e-02]
     [  4.20000000e+02   8.76780000e-02]
     [  4.21000000e+02   1.10043000e-01]
     [  4.22000000e+02   1.36705000e-01]
     [  4.23000000e+02   1.65180000e-01]
     [  4.24000000e+02   1.99071000e-01]
     [  4.25000000e+02   2.41976000e-01]
     [  4.26000000e+02   2.93837000e-01]
     [  4.27000000e+02   3.59177000e-01]
     [  4.28000000e+02   4.34192000e-01]
     [  4.29000000e+02   5.23828000e-01]
     [  4.30000000e+02   6.32578000e-01]
     [  4.31000000e+02   7.58893000e-01]
     [  4.32000000e+02   9.15528000e-01]
     [  4.33000000e+02   1.09648900e+00]
     [  4.34000000e+02   1.30748700e+00]
     [  4.35000000e+02   1.55712500e+00]
     [  4.36000000e+02   1.83877900e+00]
     [  4.37000000e+02   2.18338200e+00]
     [  4.38000000e+02   2.58625100e+00]
     [  4.39000000e+02   3.05402200e+00]
     [  4.40000000e+02   3.62565900e+00]
     [  4.41000000e+02   4.27953800e+00]
     [  4.42000000e+02   5.05583800e+00]
     [  4.43000000e+02   5.91930100e+00]
     [  4.44000000e+02   6.86992600e+00]
     [  4.45000000e+02   7.94029800e+00]
     [  4.46000000e+02   9.09021900e+00]
     [  4.47000000e+02   1.03366700e+01]
     [  4.48000000e+02   1.16198950e+01]
     [  4.49000000e+02   1.29397390e+01]
     [  4.50000000e+02   1.42069180e+01]
     [  4.51000000e+02   1.53966600e+01]
     [  4.52000000e+02   1.64305360e+01]
     [  4.53000000e+02   1.72673740e+01]
     [  4.54000000e+02   1.79122920e+01]
     [  4.55000000e+02   1.82611850e+01]
     [  4.56000000e+02   1.84045810e+01]
     [  4.57000000e+02   1.82880250e+01]
     [  4.58000000e+02   1.80023020e+01]
     [  4.59000000e+02   1.75703720e+01]
     [  4.60000000e+02   1.70112970e+01]
     [  4.61000000e+02   1.64111370e+01]
     [  4.62000000e+02   1.57794400e+01]
     [  4.63000000e+02   1.51689510e+01]
     [  4.64000000e+02   1.45853640e+01]
     [  4.65000000e+02   1.40578720e+01]
     [  4.66000000e+02   1.35757680e+01]
     [  4.67000000e+02   1.31449530e+01]
     [  4.68000000e+02   1.27373070e+01]
     [  4.69000000e+02   1.23461880e+01]
     [  4.70000000e+02   1.19673130e+01]
     [  4.71000000e+02   1.15903080e+01]
     [  4.72000000e+02   1.12098070e+01]
     [  4.73000000e+02   1.08153720e+01]
     [  4.74000000e+02   1.04067480e+01]
     [  4.75000000e+02   1.00072840e+01]
     [  4.76000000e+02   9.62788600e+00]
     [  4.77000000e+02   9.27928600e+00]
     [  4.78000000e+02   8.95839100e+00]
     [  4.79000000e+02   8.66311500e+00]
     [  4.80000000e+02   8.42736200e+00]
     [  4.81000000e+02   8.23875900e+00]
     [  4.82000000e+02   8.11020000e+00]
     [  4.83000000e+02   8.01104800e+00]
     [  4.84000000e+02   7.93912500e+00]
     [  4.85000000e+02   7.90034300e+00]
     [  4.86000000e+02   7.88070300e+00]
     [  4.87000000e+02   7.88727100e+00]
     [  4.88000000e+02   7.90704700e+00]
     [  4.89000000e+02   7.93989500e+00]
     [  4.90000000e+02   7.97729800e+00]
     [  4.91000000e+02   8.01344300e+00]
     [  4.92000000e+02   8.05675600e+00]
     [  4.93000000e+02   8.11261700e+00]
     [  4.94000000e+02   8.18139800e+00]
     [  4.95000000e+02   8.25614800e+00]
     [  4.96000000e+02   8.33260900e+00]
     [  4.97000000e+02   8.41801400e+00]
     [  4.98000000e+02   8.51314800e+00]
     [  4.99000000e+02   8.61678500e+00]
     [  5.00000000e+02   8.71903600e+00]
     [  5.01000000e+02   8.81777600e+00]
     [  5.02000000e+02   8.91441700e+00]
     [  5.03000000e+02   9.01125500e+00]
     [  5.04000000e+02   9.10525500e+00]
     [  5.05000000e+02   9.19321700e+00]
     [  5.06000000e+02   9.27488900e+00]
     [  5.07000000e+02   9.35075100e+00]
     [  5.08000000e+02   9.42382000e+00]
     [  5.09000000e+02   9.49099200e+00]
     [  5.10000000e+02   9.55321500e+00]
     [  5.11000000e+02   9.60833500e+00]
     [  5.12000000e+02   9.65384100e+00]
     [  5.13000000e+02   9.69134700e+00]
     [  5.14000000e+02   9.72714600e+00]
     [  5.15000000e+02   9.76772200e+00]
     [  5.16000000e+02   9.80906400e+00]
     [  5.17000000e+02   9.84256500e+00]
     [  5.18000000e+02   9.86752700e+00]
     [  5.19000000e+02   9.88721900e+00]
     [  5.20000000e+02   9.90610500e+00]
     [  5.21000000e+02   9.92043300e+00]
     [  5.22000000e+02   9.92930400e+00]
     [  5.23000000e+02   9.93285600e+00]
     [  5.24000000e+02   9.93520400e+00]
     [  5.25000000e+02   9.93799100e+00]
     [  5.26000000e+02   9.93844800e+00]
     [  5.27000000e+02   9.93612700e+00]
     [  5.28000000e+02   9.93019200e+00]
     [  5.29000000e+02   9.92266500e+00]
     [  5.30000000e+02   9.91394400e+00]
     [  5.31000000e+02   9.90577400e+00]
     [  5.32000000e+02   9.89876700e+00]
     [  5.33000000e+02   9.89421900e+00]
     [  5.34000000e+02   9.89147900e+00]
     [  5.35000000e+02   9.88371100e+00]
     [  5.36000000e+02   9.86269300e+00]
     [  5.37000000e+02   9.82916800e+00]
     [  5.38000000e+02   9.79525700e+00]
     [  5.39000000e+02   9.76763300e+00]
     [  5.40000000e+02   9.74738000e+00]
     [  5.41000000e+02   9.72966900e+00]
     [  5.42000000e+02   9.71488600e+00]
     [  5.43000000e+02   9.70135500e+00]
     [  5.44000000e+02   9.68831100e+00]
     [  5.45000000e+02   9.67367000e+00]
     [  5.46000000e+02   9.65702700e+00]
     [  5.47000000e+02   9.63331000e+00]
     [  5.48000000e+02   9.60312700e+00]
     [  5.49000000e+02   9.56782300e+00]
     [  5.50000000e+02   9.53404900e+00]
     [  5.51000000e+02   9.50452600e+00]
     [  5.52000000e+02   9.48417800e+00]
     [  5.53000000e+02   9.47173900e+00]
     [  5.54000000e+02   9.45596900e+00]
     [  5.55000000e+02   9.42955700e+00]
     [  5.56000000e+02   9.39645000e+00]
     [  5.57000000e+02   9.36884800e+00]
     [  5.58000000e+02   9.34483200e+00]
     [  5.59000000e+02   9.31394200e+00]
     [  5.60000000e+02   9.27392200e+00]
     [  5.61000000e+02   9.24076700e+00]
     [  5.62000000e+02   9.22098700e+00]
     [  5.63000000e+02   9.21074900e+00]
     [  5.64000000e+02   9.19580000e+00]
     [  5.65000000e+02   9.17339200e+00]
     [  5.66000000e+02   9.14390600e+00]
     [  5.67000000e+02   9.10971000e+00]
     [  5.68000000e+02   9.07823200e+00]
     [  5.69000000e+02   9.05259300e+00]
     [  5.70000000e+02   9.02323400e+00]
     [  5.71000000e+02   8.98489500e+00]
     [  5.72000000e+02   8.95066300e+00]
     [  5.73000000e+02   8.93517900e+00]
     [  5.74000000e+02   8.93630500e+00]
     [  5.75000000e+02   8.93727200e+00]
     [  5.76000000e+02   8.93167100e+00]
     [  5.77000000e+02   8.92145100e+00]
     [  5.78000000e+02   8.91028900e+00]
     [  5.79000000e+02   8.90861900e+00]
     [  5.80000000e+02   8.91788800e+00]
     [  5.81000000e+02   8.93453000e+00]
     [  5.82000000e+02   8.94678400e+00]
     [  5.83000000e+02   8.95876400e+00]
     [  5.84000000e+02   8.97933400e+00]
     [  5.85000000e+02   9.00791300e+00]
     [  5.86000000e+02   9.03354300e+00]
     [  5.87000000e+02   9.05111300e+00]
     [  5.88000000e+02   9.06784200e+00]
     [  5.89000000e+02   9.08989900e+00]
     [  5.90000000e+02   9.11454600e+00]
     [  5.91000000e+02   9.13610600e+00]
     [  5.92000000e+02   9.16427000e+00]
     [  5.93000000e+02   9.20753600e+00]
     [  5.94000000e+02   9.26421100e+00]
     [  5.95000000e+02   9.32152800e+00]
     [  5.96000000e+02   9.37177800e+00]
     [  5.97000000e+02   9.41120900e+00]
     [  5.98000000e+02   9.44372900e+00]
     [  5.99000000e+02   9.49062300e+00]
     [  6.00000000e+02   9.55787100e+00]
     [  6.01000000e+02   9.62675200e+00]
     [  6.02000000e+02   9.67483200e+00]
     [  6.03000000e+02   9.70585600e+00]
     [  6.04000000e+02   9.73942900e+00]
     [  6.05000000e+02   9.78406200e+00]
     [  6.06000000e+02   9.84126800e+00]
     [  6.07000000e+02   9.90708400e+00]
     [  6.08000000e+02   9.97184500e+00]
     [  6.09000000e+02   1.00268230e+01]
     [  6.10000000e+02   1.00600760e+01]
     [  6.11000000e+02   1.00769030e+01]
     [  6.12000000e+02   1.01059140e+01]
     [  6.13000000e+02   1.01612870e+01]
     [  6.14000000e+02   1.02301080e+01]
     [  6.15000000e+02   1.02859820e+01]
     [  6.16000000e+02   1.03365980e+01]
     [  6.17000000e+02   1.03960160e+01]
     [  6.18000000e+02   1.04490150e+01]
     [  6.19000000e+02   1.04782960e+01]
     [  6.20000000e+02   1.04846200e+01]
     [  6.21000000e+02   1.04875370e+01]
     [  6.22000000e+02   1.04989960e+01]
     [  6.23000000e+02   1.05195720e+01]
     [  6.24000000e+02   1.05414950e+01]
     [  6.25000000e+02   1.05498630e+01]
     [  6.26000000e+02   1.05432880e+01]
     [  6.27000000e+02   1.05382410e+01]
     [  6.28000000e+02   1.05468650e+01]
     [  6.29000000e+02   1.05606870e+01]
     [  6.30000000e+02   1.05679540e+01]
     [  6.31000000e+02   1.05643690e+01]
     [  6.32000000e+02   1.05559190e+01]
     [  6.33000000e+02   1.05420540e+01]
     [  6.34000000e+02   1.05274170e+01]
     [  6.35000000e+02   1.05133320e+01]
     [  6.36000000e+02   1.05006410e+01]
     [  6.37000000e+02   1.04933410e+01]
     [  6.38000000e+02   1.04917140e+01]
     [  6.39000000e+02   1.04770330e+01]
     [  6.40000000e+02   1.04359870e+01]
     [  6.41000000e+02   1.03749220e+01]
     [  6.42000000e+02   1.03174160e+01]
     [  6.43000000e+02   1.02695830e+01]
     [  6.44000000e+02   1.02209370e+01]
     [  6.45000000e+02   1.01680040e+01]
     [  6.46000000e+02   1.01157190e+01]
     [  6.47000000e+02   1.00617400e+01]
     [  6.48000000e+02   9.99849200e+00]
     [  6.49000000e+02   9.91903000e+00]
     [  6.50000000e+02   9.82122300e+00]
     [  6.51000000e+02   9.71680000e+00]
     [  6.52000000e+02   9.61991500e+00]
     [  6.53000000e+02   9.53160200e+00]
     [  6.54000000e+02   9.43576900e+00]
     [  6.55000000e+02   9.32664400e+00]
     [  6.56000000e+02   9.21594000e+00]
     [  6.57000000e+02   9.11138400e+00]
     [  6.58000000e+02   9.00510200e+00]
     [  6.59000000e+02   8.89204600e+00]
     [  6.60000000e+02   8.77578300e+00]
     [  6.61000000e+02   8.65911800e+00]
     [  6.62000000e+02   8.53783500e+00]
     [  6.63000000e+02   8.41346900e+00]
     [  6.64000000e+02   8.29258700e+00]
     [  6.65000000e+02   8.17584900e+00]
     [  6.66000000e+02   8.05560600e+00]
     [  6.67000000e+02   7.93136900e+00]
     [  6.68000000e+02   7.81247900e+00]
     [  6.69000000e+02   7.69550500e+00]
     [  6.70000000e+02   7.56471800e+00]
     [  6.71000000e+02   7.42219500e+00]
     [  6.72000000e+02   7.28637500e+00]
     [  6.73000000e+02   7.16608700e+00]
     [  6.74000000e+02   7.05015900e+00]
     [  6.75000000e+02   6.92560900e+00]
     [  6.76000000e+02   6.79267500e+00]
     [  6.77000000e+02   6.65994600e+00]
     [  6.78000000e+02   6.53433300e+00]
     [  6.79000000e+02   6.41604400e+00]
     [  6.80000000e+02   6.29808600e+00]
     [  6.81000000e+02   6.18229600e+00]
     [  6.82000000e+02   6.07310500e+00]
     [  6.83000000e+02   5.96593300e+00]
     [  6.84000000e+02   5.85368200e+00]
     [  6.85000000e+02   5.72993100e+00]
     [  6.86000000e+02   5.59987700e+00]
     [  6.87000000e+02   5.48067000e+00]
     [  6.88000000e+02   5.37621300e+00]
     [  6.89000000e+02   5.27322100e+00]
     [  6.90000000e+02   5.15623400e+00]
     [  6.91000000e+02   5.02709100e+00]
     [  6.92000000e+02   4.90024200e+00]
     [  6.93000000e+02   4.77704600e+00]
     [  6.94000000e+02   4.65828800e+00]
     [  6.95000000e+02   4.54701000e+00]
     [  6.96000000e+02   4.44356000e+00]
     [  6.97000000e+02   4.34772200e+00]
     [  6.98000000e+02   4.25215900e+00]
     [  6.99000000e+02   4.15264300e+00]
     [  7.00000000e+02   4.05390600e+00]
     [  7.01000000e+02   3.96185300e+00]
     [  7.02000000e+02   3.86506100e+00]
     [  7.03000000e+02   3.75530200e+00]
     [  7.04000000e+02   3.63486100e+00]
     [  7.05000000e+02   3.51936000e+00]
     [  7.06000000e+02   3.41880300e+00]
     [  7.07000000e+02   3.32857100e+00]
     [  7.08000000e+02   3.24645800e+00]
     [  7.09000000e+02   3.16022500e+00]
     [  7.10000000e+02   3.06638600e+00]
     [  7.11000000e+02   2.97029000e+00]
     [  7.12000000e+02   2.87809800e+00]
     [  7.13000000e+02   2.79031100e+00]
     [  7.14000000e+02   2.70126500e+00]
     [  7.15000000e+02   2.60764600e+00]
     [  7.16000000e+02   2.51549000e+00]
     [  7.17000000e+02   2.43531300e+00]
     [  7.18000000e+02   2.36150500e+00]
     [  7.19000000e+02   2.28227100e+00]
     [  7.20000000e+02   2.19250000e+00]
     [  7.21000000e+02   2.10159400e+00]
     [  7.22000000e+02   2.02735600e+00]
     [  7.23000000e+02   1.96655300e+00]
     [  7.24000000e+02   1.91294800e+00]
     [  7.25000000e+02   1.85519300e+00]
     [  7.26000000e+02   1.78513800e+00]
     [  7.27000000e+02   1.71066700e+00]
     [  7.28000000e+02   1.63878500e+00]
     [  7.29000000e+02   1.58238500e+00]
     [  7.30000000e+02   1.53922800e+00]
     [  7.31000000e+02   1.49854800e+00]
     [  7.32000000e+02   1.45540700e+00]
     [  7.33000000e+02   1.41303400e+00]
     [  7.34000000e+02   1.37202100e+00]
     [  7.35000000e+02   1.32477200e+00]
     [  7.36000000e+02   1.27715700e+00]
     [  7.37000000e+02   1.23888800e+00]
     [  7.38000000e+02   1.21111300e+00]
     [  7.39000000e+02   1.18254100e+00]
     [  7.40000000e+02   1.14938200e+00]
     [  7.41000000e+02   1.11849000e+00]
     [  7.42000000e+02   1.09120400e+00]
     [  7.43000000e+02   1.06553900e+00]
     [  7.44000000e+02   1.03956400e+00]
     [  7.45000000e+02   1.01314800e+00]
     [  7.46000000e+02   9.90818000e-01]
     [  7.47000000e+02   9.76522000e-01]
     [  7.48000000e+02   9.60074000e-01]
     [  7.49000000e+02   9.35639000e-01]
     [  7.50000000e+02   9.05095000e-01]
     [  7.51000000e+02   8.78893000e-01]
     [  7.52000000e+02   8.62828000e-01]
     [  7.53000000e+02   8.47588000e-01]
     [  7.54000000e+02   8.29938000e-01]
     [  7.55000000e+02   8.08772000e-01]
     [  7.56000000e+02   7.86338000e-01]
     [  7.57000000e+02   7.61752000e-01]
     [  7.58000000e+02   7.35873000e-01]
     [  7.59000000e+02   7.11232000e-01]
     [  7.60000000e+02   6.90947000e-01]
     [  7.61000000e+02   6.73476000e-01]
     [  7.62000000e+02   6.59236000e-01]
     [  7.63000000e+02   6.46735000e-01]
     [  7.64000000e+02   6.33802000e-01]
     [  7.65000000e+02   6.12864000e-01]
     [  7.66000000e+02   5.89102000e-01]
     [  7.67000000e+02   5.67989000e-01]
     [  7.68000000e+02   5.51288000e-01]
     [  7.69000000e+02   5.33479000e-01]
     [  7.70000000e+02   5.08426000e-01]
     [  7.71000000e+02   4.87143000e-01]
     [  7.72000000e+02   4.74126000e-01]
     [  7.73000000e+02   4.65145000e-01]
     [  7.74000000e+02   4.55158000e-01]
     [  7.75000000e+02   4.42994000e-01]
     [  7.76000000e+02   4.29114000e-01]
     [  7.77000000e+02   4.19402000e-01]
     [  7.78000000e+02   4.11766000e-01]
     [  7.79000000e+02   4.11766000e-01]
     [  7.80000000e+02   4.11766000e-01]]
    >>> sd.header.comments # doctest: +SKIP
    {"Model Name": "CV600", "Serial Number": "19J00789",
    "Time": "2021/01/04_23:14:46", "Memo": [], "LUX": 695.154907,
    "fc": 64.605476, "CCT": 5198.0, "Duv": -0.00062, "I-Time": 12000.0,
    "X": 682.470886, "Y": 695.154907, "Z": 631.635071, "x": 0.339663,
    "y": 0.345975, "u'": 0.209915, "v'": 0.481087, "LambdaP": 456.0,
    "LambdaPValue": 18.404581, "CRI": 92.956993, "R1": 91.651062,
    "R2": 93.014732, "R3": 97.032013, "R4": 93.513229, "R5": 92.48259,
    "R6": 91.48687, "R7": 93.016129, "R8": 91.459312, "R9": 77.613075,
    "R10": 86.981613, "R11": 94.841324, "R12": 74.139542, "R13": 91.073837,
    "R14": 97.064323, "R15": 88.615669, "TLCI": 97.495056,
    "TLMF-A": 1.270032, "SSI-A": 44.881924, "Rf": 87.234917, "Rg": 98.510712,
    "IRR": 2.607891}
    >>> sd.write(join(directory, 'sd.spdx')) # doctest: +SKIP
    """

    def __init__(self, path, delimiter='\t', spectra_section="380", **kwargs):
        super(SpectralDistribution_UPRTek, self).__init__(path, **kwargs)

        self._delimiter = '\t'
        self.delimiter = delimiter

        self._spectra_section = '380'
        self.spectra_section = spectra_section

        self._metadata = {}

    @property
    def delimiter(self):
        """
        Getter and setter property for the delimiter.

        Parameters
        ----------
        value : unicode
            Value to set the delimiter with.

        Returns
        -------
        unicode
            Delimiter.
        """

        return self._delimiter

    @delimiter.setter
    def delimiter(self, value):
        """
        Setter for the **self.delimiter** property.
        """

        if value is not None:
            assert is_string(
                value
            ), '"{0}" attribute: "{1}" is not a "string" like object!'.format(
                "delimiter", value)

        self._delimiter = value

    @property
    def spectra_section(self):
        """
        Getter and setter property for the spectral section.

        Parameters
        ----------
        value : unicode
            Value to set the spectral section with.

        Returns
        -------
        unicode
            Spectra section.
        """

        return self._spectra_section

    @spectra_section.setter
    def spectra_section(self, value):
        """
        Setter for the **self.spectra_section** property.
        """

        if value is not None:
            assert is_string(
                value
            ), '"{0}" attribute: "{1}" is not a "string" like object!'.format(
                "spectra_section", value)

        self._spectra_section = value

    @property
    def metadata(self):
        """
        Getter and setter property for the metadata.

        Parameters
        ----------
        value : dict
            Value to set the metadata with.

        Returns
        -------
        unicode
            Metadata.
        """

        return self._metadata

    def read(self):
        """
        Reads and parses the spectral data from a given *UPRTek* CSV file.

        Returns
        -------
        bool
            Definition success.

        Examples
        --------
        >>> from os.path import dirname, join
        >>> directory = join(dirname(__file__), 'tests', 'resources')
        >>> sd = SpectralDistribution_UPRTek(join(directory, 'uprtek.xls.txt'))
        >>> print(sd.read())
        [[  3.80000000e+02   3.02670000e-02]
         [  3.81000000e+02   3.02670000e-02]
         [  3.82000000e+02   3.02670000e-02]
         [  3.83000000e+02   2.98220000e-02]
         [  3.84000000e+02   2.89780000e-02]
         [  3.85000000e+02   2.86230000e-02]
         [  3.86000000e+02   3.08450000e-02]
         [  3.87000000e+02   3.55960000e-02]
         [  3.88000000e+02   3.92310000e-02]
         [  3.89000000e+02   3.90640000e-02]
         [  3.90000000e+02   3.52230000e-02]
         [  3.91000000e+02   3.15800000e-02]
         [  3.92000000e+02   2.91810000e-02]
         [  3.93000000e+02   2.78080000e-02]
         [  3.94000000e+02   2.62560000e-02]
         [  3.95000000e+02   2.45260000e-02]
         [  3.96000000e+02   2.25570000e-02]
         [  3.97000000e+02   2.04190000e-02]
         [  3.98000000e+02   1.85210000e-02]
         [  3.99000000e+02   1.81490000e-02]
         [  4.00000000e+02   1.93250000e-02]
         [  4.01000000e+02   2.16660000e-02]
         [  4.02000000e+02   2.40450000e-02]
         [  4.03000000e+02   2.64730000e-02]
         [  4.04000000e+02   2.90760000e-02]
         [  4.05000000e+02   3.18400000e-02]
         [  4.06000000e+02   3.38840000e-02]
         [  4.07000000e+02   3.40380000e-02]
         [  4.08000000e+02   3.23020000e-02]
         [  4.09000000e+02   3.03830000e-02]
         [  4.10000000e+02   2.94260000e-02]
         [  4.11000000e+02   2.99790000e-02]
         [  4.12000000e+02   3.26140000e-02]
         [  4.13000000e+02   3.72040000e-02]
         [  4.14000000e+02   4.22790000e-02]
         [  4.15000000e+02   4.60290000e-02]
         [  4.16000000e+02   4.86980000e-02]
         [  4.17000000e+02   5.30640000e-02]
         [  4.18000000e+02   5.95300000e-02]
         [  4.19000000e+02   7.08400000e-02]
         [  4.20000000e+02   8.76780000e-02]
         [  4.21000000e+02   1.10043000e-01]
         [  4.22000000e+02   1.36705000e-01]
         [  4.23000000e+02   1.65180000e-01]
         [  4.24000000e+02   1.99071000e-01]
         [  4.25000000e+02   2.41976000e-01]
         [  4.26000000e+02   2.93837000e-01]
         [  4.27000000e+02   3.59177000e-01]
         [  4.28000000e+02   4.34192000e-01]
         [  4.29000000e+02   5.23828000e-01]
         [  4.30000000e+02   6.32578000e-01]
         [  4.31000000e+02   7.58893000e-01]
         [  4.32000000e+02   9.15528000e-01]
         [  4.33000000e+02   1.09648900e+00]
         [  4.34000000e+02   1.30748700e+00]
         [  4.35000000e+02   1.55712500e+00]
         [  4.36000000e+02   1.83877900e+00]
         [  4.37000000e+02   2.18338200e+00]
         [  4.38000000e+02   2.58625100e+00]
         [  4.39000000e+02   3.05402200e+00]
         [  4.40000000e+02   3.62565900e+00]
         [  4.41000000e+02   4.27953800e+00]
         [  4.42000000e+02   5.05583800e+00]
         [  4.43000000e+02   5.91930100e+00]
         [  4.44000000e+02   6.86992600e+00]
         [  4.45000000e+02   7.94029800e+00]
         [  4.46000000e+02   9.09021900e+00]
         [  4.47000000e+02   1.03366700e+01]
         [  4.48000000e+02   1.16198950e+01]
         [  4.49000000e+02   1.29397390e+01]
         [  4.50000000e+02   1.42069180e+01]
         [  4.51000000e+02   1.53966600e+01]
         [  4.52000000e+02   1.64305360e+01]
         [  4.53000000e+02   1.72673740e+01]
         [  4.54000000e+02   1.79122920e+01]
         [  4.55000000e+02   1.82611850e+01]
         [  4.56000000e+02   1.84045810e+01]
         [  4.57000000e+02   1.82880250e+01]
         [  4.58000000e+02   1.80023020e+01]
         [  4.59000000e+02   1.75703720e+01]
         [  4.60000000e+02   1.70112970e+01]
         [  4.61000000e+02   1.64111370e+01]
         [  4.62000000e+02   1.57794400e+01]
         [  4.63000000e+02   1.51689510e+01]
         [  4.64000000e+02   1.45853640e+01]
         [  4.65000000e+02   1.40578720e+01]
         [  4.66000000e+02   1.35757680e+01]
         [  4.67000000e+02   1.31449530e+01]
         [  4.68000000e+02   1.27373070e+01]
         [  4.69000000e+02   1.23461880e+01]
         [  4.70000000e+02   1.19673130e+01]
         [  4.71000000e+02   1.15903080e+01]
         [  4.72000000e+02   1.12098070e+01]
         [  4.73000000e+02   1.08153720e+01]
         [  4.74000000e+02   1.04067480e+01]
         [  4.75000000e+02   1.00072840e+01]
         [  4.76000000e+02   9.62788600e+00]
         [  4.77000000e+02   9.27928600e+00]
         [  4.78000000e+02   8.95839100e+00]
         [  4.79000000e+02   8.66311500e+00]
         [  4.80000000e+02   8.42736200e+00]
         [  4.81000000e+02   8.23875900e+00]
         [  4.82000000e+02   8.11020000e+00]
         [  4.83000000e+02   8.01104800e+00]
         [  4.84000000e+02   7.93912500e+00]
         [  4.85000000e+02   7.90034300e+00]
         [  4.86000000e+02   7.88070300e+00]
         [  4.87000000e+02   7.88727100e+00]
         [  4.88000000e+02   7.90704700e+00]
         [  4.89000000e+02   7.93989500e+00]
         [  4.90000000e+02   7.97729800e+00]
         [  4.91000000e+02   8.01344300e+00]
         [  4.92000000e+02   8.05675600e+00]
         [  4.93000000e+02   8.11261700e+00]
         [  4.94000000e+02   8.18139800e+00]
         [  4.95000000e+02   8.25614800e+00]
         [  4.96000000e+02   8.33260900e+00]
         [  4.97000000e+02   8.41801400e+00]
         [  4.98000000e+02   8.51314800e+00]
         [  4.99000000e+02   8.61678500e+00]
         [  5.00000000e+02   8.71903600e+00]
         [  5.01000000e+02   8.81777600e+00]
         [  5.02000000e+02   8.91441700e+00]
         [  5.03000000e+02   9.01125500e+00]
         [  5.04000000e+02   9.10525500e+00]
         [  5.05000000e+02   9.19321700e+00]
         [  5.06000000e+02   9.27488900e+00]
         [  5.07000000e+02   9.35075100e+00]
         [  5.08000000e+02   9.42382000e+00]
         [  5.09000000e+02   9.49099200e+00]
         [  5.10000000e+02   9.55321500e+00]
         [  5.11000000e+02   9.60833500e+00]
         [  5.12000000e+02   9.65384100e+00]
         [  5.13000000e+02   9.69134700e+00]
         [  5.14000000e+02   9.72714600e+00]
         [  5.15000000e+02   9.76772200e+00]
         [  5.16000000e+02   9.80906400e+00]
         [  5.17000000e+02   9.84256500e+00]
         [  5.18000000e+02   9.86752700e+00]
         [  5.19000000e+02   9.88721900e+00]
         [  5.20000000e+02   9.90610500e+00]
         [  5.21000000e+02   9.92043300e+00]
         [  5.22000000e+02   9.92930400e+00]
         [  5.23000000e+02   9.93285600e+00]
         [  5.24000000e+02   9.93520400e+00]
         [  5.25000000e+02   9.93799100e+00]
         [  5.26000000e+02   9.93844800e+00]
         [  5.27000000e+02   9.93612700e+00]
         [  5.28000000e+02   9.93019200e+00]
         [  5.29000000e+02   9.92266500e+00]
         [  5.30000000e+02   9.91394400e+00]
         [  5.31000000e+02   9.90577400e+00]
         [  5.32000000e+02   9.89876700e+00]
         [  5.33000000e+02   9.89421900e+00]
         [  5.34000000e+02   9.89147900e+00]
         [  5.35000000e+02   9.88371100e+00]
         [  5.36000000e+02   9.86269300e+00]
         [  5.37000000e+02   9.82916800e+00]
         [  5.38000000e+02   9.79525700e+00]
         [  5.39000000e+02   9.76763300e+00]
         [  5.40000000e+02   9.74738000e+00]
         [  5.41000000e+02   9.72966900e+00]
         [  5.42000000e+02   9.71488600e+00]
         [  5.43000000e+02   9.70135500e+00]
         [  5.44000000e+02   9.68831100e+00]
         [  5.45000000e+02   9.67367000e+00]
         [  5.46000000e+02   9.65702700e+00]
         [  5.47000000e+02   9.63331000e+00]
         [  5.48000000e+02   9.60312700e+00]
         [  5.49000000e+02   9.56782300e+00]
         [  5.50000000e+02   9.53404900e+00]
         [  5.51000000e+02   9.50452600e+00]
         [  5.52000000e+02   9.48417800e+00]
         [  5.53000000e+02   9.47173900e+00]
         [  5.54000000e+02   9.45596900e+00]
         [  5.55000000e+02   9.42955700e+00]
         [  5.56000000e+02   9.39645000e+00]
         [  5.57000000e+02   9.36884800e+00]
         [  5.58000000e+02   9.34483200e+00]
         [  5.59000000e+02   9.31394200e+00]
         [  5.60000000e+02   9.27392200e+00]
         [  5.61000000e+02   9.24076700e+00]
         [  5.62000000e+02   9.22098700e+00]
         [  5.63000000e+02   9.21074900e+00]
         [  5.64000000e+02   9.19580000e+00]
         [  5.65000000e+02   9.17339200e+00]
         [  5.66000000e+02   9.14390600e+00]
         [  5.67000000e+02   9.10971000e+00]
         [  5.68000000e+02   9.07823200e+00]
         [  5.69000000e+02   9.05259300e+00]
         [  5.70000000e+02   9.02323400e+00]
         [  5.71000000e+02   8.98489500e+00]
         [  5.72000000e+02   8.95066300e+00]
         [  5.73000000e+02   8.93517900e+00]
         [  5.74000000e+02   8.93630500e+00]
         [  5.75000000e+02   8.93727200e+00]
         [  5.76000000e+02   8.93167100e+00]
         [  5.77000000e+02   8.92145100e+00]
         [  5.78000000e+02   8.91028900e+00]
         [  5.79000000e+02   8.90861900e+00]
         [  5.80000000e+02   8.91788800e+00]
         [  5.81000000e+02   8.93453000e+00]
         [  5.82000000e+02   8.94678400e+00]
         [  5.83000000e+02   8.95876400e+00]
         [  5.84000000e+02   8.97933400e+00]
         [  5.85000000e+02   9.00791300e+00]
         [  5.86000000e+02   9.03354300e+00]
         [  5.87000000e+02   9.05111300e+00]
         [  5.88000000e+02   9.06784200e+00]
         [  5.89000000e+02   9.08989900e+00]
         [  5.90000000e+02   9.11454600e+00]
         [  5.91000000e+02   9.13610600e+00]
         [  5.92000000e+02   9.16427000e+00]
         [  5.93000000e+02   9.20753600e+00]
         [  5.94000000e+02   9.26421100e+00]
         [  5.95000000e+02   9.32152800e+00]
         [  5.96000000e+02   9.37177800e+00]
         [  5.97000000e+02   9.41120900e+00]
         [  5.98000000e+02   9.44372900e+00]
         [  5.99000000e+02   9.49062300e+00]
         [  6.00000000e+02   9.55787100e+00]
         [  6.01000000e+02   9.62675200e+00]
         [  6.02000000e+02   9.67483200e+00]
         [  6.03000000e+02   9.70585600e+00]
         [  6.04000000e+02   9.73942900e+00]
         [  6.05000000e+02   9.78406200e+00]
         [  6.06000000e+02   9.84126800e+00]
         [  6.07000000e+02   9.90708400e+00]
         [  6.08000000e+02   9.97184500e+00]
         [  6.09000000e+02   1.00268230e+01]
         [  6.10000000e+02   1.00600760e+01]
         [  6.11000000e+02   1.00769030e+01]
         [  6.12000000e+02   1.01059140e+01]
         [  6.13000000e+02   1.01612870e+01]
         [  6.14000000e+02   1.02301080e+01]
         [  6.15000000e+02   1.02859820e+01]
         [  6.16000000e+02   1.03365980e+01]
         [  6.17000000e+02   1.03960160e+01]
         [  6.18000000e+02   1.04490150e+01]
         [  6.19000000e+02   1.04782960e+01]
         [  6.20000000e+02   1.04846200e+01]
         [  6.21000000e+02   1.04875370e+01]
         [  6.22000000e+02   1.04989960e+01]
         [  6.23000000e+02   1.05195720e+01]
         [  6.24000000e+02   1.05414950e+01]
         [  6.25000000e+02   1.05498630e+01]
         [  6.26000000e+02   1.05432880e+01]
         [  6.27000000e+02   1.05382410e+01]
         [  6.28000000e+02   1.05468650e+01]
         [  6.29000000e+02   1.05606870e+01]
         [  6.30000000e+02   1.05679540e+01]
         [  6.31000000e+02   1.05643690e+01]
         [  6.32000000e+02   1.05559190e+01]
         [  6.33000000e+02   1.05420540e+01]
         [  6.34000000e+02   1.05274170e+01]
         [  6.35000000e+02   1.05133320e+01]
         [  6.36000000e+02   1.05006410e+01]
         [  6.37000000e+02   1.04933410e+01]
         [  6.38000000e+02   1.04917140e+01]
         [  6.39000000e+02   1.04770330e+01]
         [  6.40000000e+02   1.04359870e+01]
         [  6.41000000e+02   1.03749220e+01]
         [  6.42000000e+02   1.03174160e+01]
         [  6.43000000e+02   1.02695830e+01]
         [  6.44000000e+02   1.02209370e+01]
         [  6.45000000e+02   1.01680040e+01]
         [  6.46000000e+02   1.01157190e+01]
         [  6.47000000e+02   1.00617400e+01]
         [  6.48000000e+02   9.99849200e+00]
         [  6.49000000e+02   9.91903000e+00]
         [  6.50000000e+02   9.82122300e+00]
         [  6.51000000e+02   9.71680000e+00]
         [  6.52000000e+02   9.61991500e+00]
         [  6.53000000e+02   9.53160200e+00]
         [  6.54000000e+02   9.43576900e+00]
         [  6.55000000e+02   9.32664400e+00]
         [  6.56000000e+02   9.21594000e+00]
         [  6.57000000e+02   9.11138400e+00]
         [  6.58000000e+02   9.00510200e+00]
         [  6.59000000e+02   8.89204600e+00]
         [  6.60000000e+02   8.77578300e+00]
         [  6.61000000e+02   8.65911800e+00]
         [  6.62000000e+02   8.53783500e+00]
         [  6.63000000e+02   8.41346900e+00]
         [  6.64000000e+02   8.29258700e+00]
         [  6.65000000e+02   8.17584900e+00]
         [  6.66000000e+02   8.05560600e+00]
         [  6.67000000e+02   7.93136900e+00]
         [  6.68000000e+02   7.81247900e+00]
         [  6.69000000e+02   7.69550500e+00]
         [  6.70000000e+02   7.56471800e+00]
         [  6.71000000e+02   7.42219500e+00]
         [  6.72000000e+02   7.28637500e+00]
         [  6.73000000e+02   7.16608700e+00]
         [  6.74000000e+02   7.05015900e+00]
         [  6.75000000e+02   6.92560900e+00]
         [  6.76000000e+02   6.79267500e+00]
         [  6.77000000e+02   6.65994600e+00]
         [  6.78000000e+02   6.53433300e+00]
         [  6.79000000e+02   6.41604400e+00]
         [  6.80000000e+02   6.29808600e+00]
         [  6.81000000e+02   6.18229600e+00]
         [  6.82000000e+02   6.07310500e+00]
         [  6.83000000e+02   5.96593300e+00]
         [  6.84000000e+02   5.85368200e+00]
         [  6.85000000e+02   5.72993100e+00]
         [  6.86000000e+02   5.59987700e+00]
         [  6.87000000e+02   5.48067000e+00]
         [  6.88000000e+02   5.37621300e+00]
         [  6.89000000e+02   5.27322100e+00]
         [  6.90000000e+02   5.15623400e+00]
         [  6.91000000e+02   5.02709100e+00]
         [  6.92000000e+02   4.90024200e+00]
         [  6.93000000e+02   4.77704600e+00]
         [  6.94000000e+02   4.65828800e+00]
         [  6.95000000e+02   4.54701000e+00]
         [  6.96000000e+02   4.44356000e+00]
         [  6.97000000e+02   4.34772200e+00]
         [  6.98000000e+02   4.25215900e+00]
         [  6.99000000e+02   4.15264300e+00]
         [  7.00000000e+02   4.05390600e+00]
         [  7.01000000e+02   3.96185300e+00]
         [  7.02000000e+02   3.86506100e+00]
         [  7.03000000e+02   3.75530200e+00]
         [  7.04000000e+02   3.63486100e+00]
         [  7.05000000e+02   3.51936000e+00]
         [  7.06000000e+02   3.41880300e+00]
         [  7.07000000e+02   3.32857100e+00]
         [  7.08000000e+02   3.24645800e+00]
         [  7.09000000e+02   3.16022500e+00]
         [  7.10000000e+02   3.06638600e+00]
         [  7.11000000e+02   2.97029000e+00]
         [  7.12000000e+02   2.87809800e+00]
         [  7.13000000e+02   2.79031100e+00]
         [  7.14000000e+02   2.70126500e+00]
         [  7.15000000e+02   2.60764600e+00]
         [  7.16000000e+02   2.51549000e+00]
         [  7.17000000e+02   2.43531300e+00]
         [  7.18000000e+02   2.36150500e+00]
         [  7.19000000e+02   2.28227100e+00]
         [  7.20000000e+02   2.19250000e+00]
         [  7.21000000e+02   2.10159400e+00]
         [  7.22000000e+02   2.02735600e+00]
         [  7.23000000e+02   1.96655300e+00]
         [  7.24000000e+02   1.91294800e+00]
         [  7.25000000e+02   1.85519300e+00]
         [  7.26000000e+02   1.78513800e+00]
         [  7.27000000e+02   1.71066700e+00]
         [  7.28000000e+02   1.63878500e+00]
         [  7.29000000e+02   1.58238500e+00]
         [  7.30000000e+02   1.53922800e+00]
         [  7.31000000e+02   1.49854800e+00]
         [  7.32000000e+02   1.45540700e+00]
         [  7.33000000e+02   1.41303400e+00]
         [  7.34000000e+02   1.37202100e+00]
         [  7.35000000e+02   1.32477200e+00]
         [  7.36000000e+02   1.27715700e+00]
         [  7.37000000e+02   1.23888800e+00]
         [  7.38000000e+02   1.21111300e+00]
         [  7.39000000e+02   1.18254100e+00]
         [  7.40000000e+02   1.14938200e+00]
         [  7.41000000e+02   1.11849000e+00]
         [  7.42000000e+02   1.09120400e+00]
         [  7.43000000e+02   1.06553900e+00]
         [  7.44000000e+02   1.03956400e+00]
         [  7.45000000e+02   1.01314800e+00]
         [  7.46000000e+02   9.90818000e-01]
         [  7.47000000e+02   9.76522000e-01]
         [  7.48000000e+02   9.60074000e-01]
         [  7.49000000e+02   9.35639000e-01]
         [  7.50000000e+02   9.05095000e-01]
         [  7.51000000e+02   8.78893000e-01]
         [  7.52000000e+02   8.62828000e-01]
         [  7.53000000e+02   8.47588000e-01]
         [  7.54000000e+02   8.29938000e-01]
         [  7.55000000e+02   8.08772000e-01]
         [  7.56000000e+02   7.86338000e-01]
         [  7.57000000e+02   7.61752000e-01]
         [  7.58000000e+02   7.35873000e-01]
         [  7.59000000e+02   7.11232000e-01]
         [  7.60000000e+02   6.90947000e-01]
         [  7.61000000e+02   6.73476000e-01]
         [  7.62000000e+02   6.59236000e-01]
         [  7.63000000e+02   6.46735000e-01]
         [  7.64000000e+02   6.33802000e-01]
         [  7.65000000e+02   6.12864000e-01]
         [  7.66000000e+02   5.89102000e-01]
         [  7.67000000e+02   5.67989000e-01]
         [  7.68000000e+02   5.51288000e-01]
         [  7.69000000e+02   5.33479000e-01]
         [  7.70000000e+02   5.08426000e-01]
         [  7.71000000e+02   4.87143000e-01]
         [  7.72000000e+02   4.74126000e-01]
         [  7.73000000e+02   4.65145000e-01]
         [  7.74000000e+02   4.55158000e-01]
         [  7.75000000e+02   4.42994000e-01]
         [  7.76000000e+02   4.29114000e-01]
         [  7.77000000e+02   4.19402000e-01]
         [  7.78000000e+02   4.11766000e-01]
         [  7.79000000e+02   4.11766000e-01]
         [  7.80000000e+02   4.11766000e-01]]
        """

        def as_array(a):
            """
            Inputs list of numbers and converts each element to
            float data type.
            """
            return [float(e) for e in a]

        spectral_sections = defaultdict(list)
        with open(self.path, encoding="utf-8") as csv_file:
            content = csv.reader(csv_file, delimiter=self._delimiter)

            spectral_section = 0
            for row in content:
                if not "".join(row).strip():
                    continue

                key, value = row[0], row[1:]
                value = value[0] if len(value) == 1 else value

                search = re.search("(\\d{3})\\[?nm\\]?", key)
                if search:
                    wavelength = search.group(1)

                    if wavelength == self._spectra_section:
                        spectral_section += 1

                    spectral_sections[spectral_section].append(
                        [wavelength, value])
                else:
                    for method in (int, float, as_array):
                        try:
                            self._metadata[key] = method(value)
                            break
                        except Exception:
                            self._metadata[key] = value

        self.name = os.path.splitext(os.path.basename(self.path))[0]
        spectral_data = as_float_array(spectral_sections[sorted(
            spectral_sections.keys())[-1]])

        self.wavelengths = spectral_data[..., 0]
        self.values = spectral_data[..., 1]

        self.header.comments = json.dumps(self._metadata)
        self.header.report_date = self._metadata["Time"][:10]
        self.header.measurement_equipment = self._metadata["Model Name"]
        self.header.manufacturer = "UPRTek"
        self.spectral_quantity = 'Irradiance'

        return self


class SpectralDistribution_Sekonic(SpectralDistribution_UPRTek):
    def __init__(self, path, delimiter=",", spectra_section="380", **kwargs):
        super(SpectralDistribution_Sekonic, self).__init__(
            path, delimiter, spectra_section, **kwargs)
