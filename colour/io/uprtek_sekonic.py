# -*- coding: utf-8 -*-
"""
UPRTek and Sekonic Data Input
=================

Defines the input object for *UPRTek* and *Sekonic* CSV spectral data files.
-   :class:`colour.io.SpectralDistribution_UPRTek`
-   :class:`colour.io.SpectralDistribution_Sekonic`
"""

import csv
import json
import os
import re
from collections import defaultdict

from colour.io import SpectralDistribution_IESTM2714
from colour.utilities import as_float_array, is_string


class SpectralDistribution_UPRTek(SpectralDistribution_IESTM2714):
    """
    This class serves as a parser to read and write *IES TM-27-14*
    spectral data XML file from a *UPRTek* CSV file.

    Parameters
    ----------
    path : unicode
        Path for UPRTek CSV file.

    Methods
    -------
    -   :meth:`~colour.SpectralDistribution_UPRTek.__init__`
    -   :meth:`~colour.SpectralDistribution_UPRTek.read`
    -   :meth:`~colour.SpectralDistribution_UPRTek.write`

    Examples
    --------
    >>> from os.path import dirname, join
    >>> directory = join(dirname(__file__), 'tests', 'resources')
    >>> sd = SpectralDistribution_UPRTek(join(directory, 'uprtek.xls.txt'))
    >>> print(sd.read())
    [[  3.80000000e+02   3.02670000e-02]
     [  3.81000000e+02   3.02670000e-02]
     [  3.82000000e+02   3.02670000e-02]
     [  3.83000000e+02   2.98220000e-02]
     [  3.84000000e+02   2.89780000e-02]
     [  3.85000000e+02   2.86230000e-02]
     [  3.86000000e+02   3.08450000e-02]
     [  3.87000000e+02   3.55960000e-02]
     [  3.88000000e+02   3.92310000e-02]
     [  3.89000000e+02   3.90640000e-02]
     [  3.90000000e+02   3.52230000e-02]
     [  3.91000000e+02   3.15800000e-02]
     [  3.92000000e+02   2.91810000e-02]
     [  3.93000000e+02   2.78080000e-02]
     [  3.94000000e+02   2.62560000e-02]
     [  3.95000000e+02   2.45260000e-02]
     [  3.96000000e+02   2.25570000e-02]
     [  3.97000000e+02   2.04190000e-02]
     [  3.98000000e+02   1.85210000e-02]
     [  3.99000000e+02   1.81490000e-02]
     [  4.00000000e+02   1.93250000e-02]
     [  4.01000000e+02   2.16660000e-02]
     [  4.02000000e+02   2.40450000e-02]
     [  4.03000000e+02   2.64730000e-02]
     [  4.04000000e+02   2.90760000e-02]
     [  4.05000000e+02   3.18400000e-02]
     [  4.06000000e+02   3.38840000e-02]
     [  4.07000000e+02   3.40380000e-02]
     [  4.08000000e+02   3.23020000e-02]
     [  4.09000000e+02   3.03830000e-02]
     [  4.10000000e+02   2.94260000e-02]
     [  4.11000000e+02   2.99790000e-02]
     [  4.12000000e+02   3.26140000e-02]
     [  4.13000000e+02   3.72040000e-02]
     [  4.14000000e+02   4.22790000e-02]
     [  4.15000000e+02   4.60290000e-02]
     [  4.16000000e+02   4.86980000e-02]
     [  4.17000000e+02   5.30640000e-02]
     [  4.18000000e+02   5.95300000e-02]
     [  4.19000000e+02   7.08400000e-02]
     [  4.20000000e+02   8.76780000e-02]
     [  4.21000000e+02   1.10043000e-01]
     [  4.22000000e+02   1.36705000e-01]
     [  4.23000000e+02   1.65180000e-01]
     [  4.24000000e+02   1.99071000e-01]
     [  4.25000000e+02   2.41976000e-01]
     [  4.26000000e+02   2.93837000e-01]
     [  4.27000000e+02   3.59177000e-01]
     [  4.28000000e+02   4.34192000e-01]
     [  4.29000000e+02   5.23828000e-01]
     [  4.30000000e+02   6.32578000e-01]
     [  4.31000000e+02   7.58893000e-01]
     [  4.32000000e+02   9.15528000e-01]
     [  4.33000000e+02   1.09648900e+00]
     [  4.34000000e+02   1.30748700e+00]
     [  4.35000000e+02   1.55712500e+00]
     [  4.36000000e+02   1.83877900e+00]
     [  4.37000000e+02   2.18338200e+00]
     [  4.38000000e+02   2.58625100e+00]
     [  4.39000000e+02   3.05402200e+00]
     [  4.40000000e+02   3.62565900e+00]
     [  4.41000000e+02   4.27953800e+00]
     [  4.42000000e+02   5.05583800e+00]
     [  4.43000000e+02   5.91930100e+00]
     [  4.44000000e+02   6.86992600e+00]
     [  4.45000000e+02   7.94029800e+00]
     [  4.46000000e+02   9.09021900e+00]
     [  4.47000000e+02   1.03366700e+01]
     [  4.48000000e+02   1.16198950e+01]
     [  4.49000000e+02   1.29397390e+01]
     [  4.50000000e+02   1.42069180e+01]
     [  4.51000000e+02   1.53966600e+01]
     [  4.52000000e+02   1.64305360e+01]
     [  4.53000000e+02   1.72673740e+01]
     [  4.54000000e+02   1.79122920e+01]
     [  4.55000000e+02   1.82611850e+01]
     [  4.56000000e+02   1.84045810e+01]
     [  4.57000000e+02   1.82880250e+01]
     [  4.58000000e+02   1.80023020e+01]
     [  4.59000000e+02   1.75703720e+01]
     [  4.60000000e+02   1.70112970e+01]
     [  4.61000000e+02   1.64111370e+01]
     [  4.62000000e+02   1.57794400e+01]
     [  4.63000000e+02   1.51689510e+01]
     [  4.64000000e+02   1.45853640e+01]
     [  4.65000000e+02   1.40578720e+01]
     [  4.66000000e+02   1.35757680e+01]
     [  4.67000000e+02   1.31449530e+01]
     [  4.68000000e+02   1.27373070e+01]
     [  4.69000000e+02   1.23461880e+01]
     [  4.70000000e+02   1.19673130e+01]
     [  4.71000000e+02   1.15903080e+01]
     [  4.72000000e+02   1.12098070e+01]
     [  4.73000000e+02   1.08153720e+01]
     [  4.74000000e+02   1.04067480e+01]
     [  4.75000000e+02   1.00072840e+01]
     [  4.76000000e+02   9.62788600e+00]
     [  4.77000000e+02   9.27928600e+00]
     [  4.78000000e+02   8.95839100e+00]
     [  4.79000000e+02   8.66311500e+00]
     [  4.80000000e+02   8.42736200e+00]
     [  4.81000000e+02   8.23875900e+00]
     [  4.82000000e+02   8.11020000e+00]
     [  4.83000000e+02   8.01104800e+00]
     [  4.84000000e+02   7.93912500e+00]
     [  4.85000000e+02   7.90034300e+00]
     [  4.86000000e+02   7.88070300e+00]
     [  4.87000000e+02   7.88727100e+00]
     [  4.88000000e+02   7.90704700e+00]
     [  4.89000000e+02   7.93989500e+00]
     [  4.90000000e+02   7.97729800e+00]
     [  4.91000000e+02   8.01344300e+00]
     [  4.92000000e+02   8.05675600e+00]
     [  4.93000000e+02   8.11261700e+00]
     [  4.94000000e+02   8.18139800e+00]
     [  4.95000000e+02   8.25614800e+00]
     [  4.96000000e+02   8.33260900e+00]
     [  4.97000000e+02   8.41801400e+00]
     [  4.98000000e+02   8.51314800e+00]
     [  4.99000000e+02   8.61678500e+00]
     [  5.00000000e+02   8.71903600e+00]
     [  5.01000000e+02   8.81777600e+00]
     [  5.02000000e+02   8.91441700e+00]
     [  5.03000000e+02   9.01125500e+00]
     [  5.04000000e+02   9.10525500e+00]
     [  5.05000000e+02   9.19321700e+00]
     [  5.06000000e+02   9.27488900e+00]
     [  5.07000000e+02   9.35075100e+00]
     [  5.08000000e+02   9.42382000e+00]
     [  5.09000000e+02   9.49099200e+00]
     [  5.10000000e+02   9.55321500e+00]
     [  5.11000000e+02   9.60833500e+00]
     [  5.12000000e+02   9.65384100e+00]
     [  5.13000000e+02   9.69134700e+00]
     [  5.14000000e+02   9.72714600e+00]
     [  5.15000000e+02   9.76772200e+00]
     [  5.16000000e+02   9.80906400e+00]
     [  5.17000000e+02   9.84256500e+00]
     [  5.18000000e+02   9.86752700e+00]
     [  5.19000000e+02   9.88721900e+00]
     [  5.20000000e+02   9.90610500e+00]
     [  5.21000000e+02   9.92043300e+00]
     [  5.22000000e+02   9.92930400e+00]
     [  5.23000000e+02   9.93285600e+00]
     [  5.24000000e+02   9.93520400e+00]
     [  5.25000000e+02   9.93799100e+00]
     [  5.26000000e+02   9.93844800e+00]
     [  5.27000000e+02   9.93612700e+00]
     [  5.28000000e+02   9.93019200e+00]
     [  5.29000000e+02   9.92266500e+00]
     [  5.30000000e+02   9.91394400e+00]
     [  5.31000000e+02   9.90577400e+00]
     [  5.32000000e+02   9.89876700e+00]
     [  5.33000000e+02   9.89421900e+00]
     [  5.34000000e+02   9.89147900e+00]
     [  5.35000000e+02   9.88371100e+00]
     [  5.36000000e+02   9.86269300e+00]
     [  5.37000000e+02   9.82916800e+00]
     [  5.38000000e+02   9.79525700e+00]
     [  5.39000000e+02   9.76763300e+00]
     [  5.40000000e+02   9.74738000e+00]
     [  5.41000000e+02   9.72966900e+00]
     [  5.42000000e+02   9.71488600e+00]
     [  5.43000000e+02   9.70135500e+00]
     [  5.44000000e+02   9.68831100e+00]
     [  5.45000000e+02   9.67367000e+00]
     [  5.46000000e+02   9.65702700e+00]
     [  5.47000000e+02   9.63331000e+00]
     [  5.48000000e+02   9.60312700e+00]
     [  5.49000000e+02   9.56782300e+00]
     [  5.50000000e+02   9.53404900e+00]
     [  5.51000000e+02   9.50452600e+00]
     [  5.52000000e+02   9.48417800e+00]
     [  5.53000000e+02   9.47173900e+00]
     [  5.54000000e+02   9.45596900e+00]
     [  5.55000000e+02   9.42955700e+00]
     [  5.56000000e+02   9.39645000e+00]
     [  5.57000000e+02   9.36884800e+00]
     [  5.58000000e+02   9.34483200e+00]
     [  5.59000000e+02   9.31394200e+00]
     [  5.60000000e+02   9.27392200e+00]
     [  5.61000000e+02   9.24076700e+00]
     [  5.62000000e+02   9.22098700e+00]
     [  5.63000000e+02   9.21074900e+00]
     [  5.64000000e+02   9.19580000e+00]
     [  5.65000000e+02   9.17339200e+00]
     [  5.66000000e+02   9.14390600e+00]
     [  5.67000000e+02   9.10971000e+00]
     [  5.68000000e+02   9.07823200e+00]
     [  5.69000000e+02   9.05259300e+00]
     [  5.70000000e+02   9.02323400e+00]
     [  5.71000000e+02   8.98489500e+00]
     [  5.72000000e+02   8.95066300e+00]
     [  5.73000000e+02   8.93517900e+00]
     [  5.74000000e+02   8.93630500e+00]
     [  5.75000000e+02   8.93727200e+00]
     [  5.76000000e+02   8.93167100e+00]
     [  5.77000000e+02   8.92145100e+00]
     [  5.78000000e+02   8.91028900e+00]
     [  5.79000000e+02   8.90861900e+00]
     [  5.80000000e+02   8.91788800e+00]
     [  5.81000000e+02   8.93453000e+00]
     [  5.82000000e+02   8.94678400e+00]
     [  5.83000000e+02   8.95876400e+00]
     [  5.84000000e+02   8.97933400e+00]
     [  5.85000000e+02   9.00791300e+00]
     [  5.86000000e+02   9.03354300e+00]
     [  5.87000000e+02   9.05111300e+00]
     [  5.88000000e+02   9.06784200e+00]
     [  5.89000000e+02   9.08989900e+00]
     [  5.90000000e+02   9.11454600e+00]
     [  5.91000000e+02   9.13610600e+00]
     [  5.92000000e+02   9.16427000e+00]
     [  5.93000000e+02   9.20753600e+00]
     [  5.94000000e+02   9.26421100e+00]
     [  5.95000000e+02   9.32152800e+00]
     [  5.96000000e+02   9.37177800e+00]
     [  5.97000000e+02   9.41120900e+00]
     [  5.98000000e+02   9.44372900e+00]
     [  5.99000000e+02   9.49062300e+00]
     [  6.00000000e+02   9.55787100e+00]
     [  6.01000000e+02   9.62675200e+00]
     [  6.02000000e+02   9.67483200e+00]
     [  6.03000000e+02   9.70585600e+00]
     [  6.04000000e+02   9.73942900e+00]
     [  6.05000000e+02   9.78406200e+00]
     [  6.06000000e+02   9.84126800e+00]
     [  6.07000000e+02   9.90708400e+00]
     [  6.08000000e+02   9.97184500e+00]
     [  6.09000000e+02   1.00268230e+01]
     [  6.10000000e+02   1.00600760e+01]
     [  6.11000000e+02   1.00769030e+01]
     [  6.12000000e+02   1.01059140e+01]
     [  6.13000000e+02   1.01612870e+01]
     [  6.14000000e+02   1.02301080e+01]
     [  6.15000000e+02   1.02859820e+01]
     [  6.16000000e+02   1.03365980e+01]
     [  6.17000000e+02   1.03960160e+01]
     [  6.18000000e+02   1.04490150e+01]
     [  6.19000000e+02   1.04782960e+01]
     [  6.20000000e+02   1.04846200e+01]
     [  6.21000000e+02   1.04875370e+01]
     [  6.22000000e+02   1.04989960e+01]
     [  6.23000000e+02   1.05195720e+01]
     [  6.24000000e+02   1.05414950e+01]
     [  6.25000000e+02   1.05498630e+01]
     [  6.26000000e+02   1.05432880e+01]
     [  6.27000000e+02   1.05382410e+01]
     [  6.28000000e+02   1.05468650e+01]
     [  6.29000000e+02   1.05606870e+01]
     [  6.30000000e+02   1.05679540e+01]
     [  6.31000000e+02   1.05643690e+01]
     [  6.32000000e+02   1.05559190e+01]
     [  6.33000000e+02   1.05420540e+01]
     [  6.34000000e+02   1.05274170e+01]
     [  6.35000000e+02   1.05133320e+01]
     [  6.36000000e+02   1.05006410e+01]
     [  6.37000000e+02   1.04933410e+01]
     [  6.38000000e+02   1.04917140e+01]
     [  6.39000000e+02   1.04770330e+01]
     [  6.40000000e+02   1.04359870e+01]
     [  6.41000000e+02   1.03749220e+01]
     [  6.42000000e+02   1.03174160e+01]
     [  6.43000000e+02   1.02695830e+01]
     [  6.44000000e+02   1.02209370e+01]
     [  6.45000000e+02   1.01680040e+01]
     [  6.46000000e+02   1.01157190e+01]
     [  6.47000000e+02   1.00617400e+01]
     [  6.48000000e+02   9.99849200e+00]
     [  6.49000000e+02   9.91903000e+00]
     [  6.50000000e+02   9.82122300e+00]
     [  6.51000000e+02   9.71680000e+00]
     [  6.52000000e+02   9.61991500e+00]
     [  6.53000000e+02   9.53160200e+00]
     [  6.54000000e+02   9.43576900e+00]
     [  6.55000000e+02   9.32664400e+00]
     [  6.56000000e+02   9.21594000e+00]
     [  6.57000000e+02   9.11138400e+00]
     [  6.58000000e+02   9.00510200e+00]
     [  6.59000000e+02   8.89204600e+00]
     [  6.60000000e+02   8.77578300e+00]
     [  6.61000000e+02   8.65911800e+00]
     [  6.62000000e+02   8.53783500e+00]
     [  6.63000000e+02   8.41346900e+00]
     [  6.64000000e+02   8.29258700e+00]
     [  6.65000000e+02   8.17584900e+00]
     [  6.66000000e+02   8.05560600e+00]
     [  6.67000000e+02   7.93136900e+00]
     [  6.68000000e+02   7.81247900e+00]
     [  6.69000000e+02   7.69550500e+00]
     [  6.70000000e+02   7.56471800e+00]
     [  6.71000000e+02   7.42219500e+00]
     [  6.72000000e+02   7.28637500e+00]
     [  6.73000000e+02   7.16608700e+00]
     [  6.74000000e+02   7.05015900e+00]
     [  6.75000000e+02   6.92560900e+00]
     [  6.76000000e+02   6.79267500e+00]
     [  6.77000000e+02   6.65994600e+00]
     [  6.78000000e+02   6.53433300e+00]
     [  6.79000000e+02   6.41604400e+00]
     [  6.80000000e+02   6.29808600e+00]
     [  6.81000000e+02   6.18229600e+00]
     [  6.82000000e+02   6.07310500e+00]
     [  6.83000000e+02   5.96593300e+00]
     [  6.84000000e+02   5.85368200e+00]
     [  6.85000000e+02   5.72993100e+00]
     [  6.86000000e+02   5.59987700e+00]
     [  6.87000000e+02   5.48067000e+00]
     [  6.88000000e+02   5.37621300e+00]
     [  6.89000000e+02   5.27322100e+00]
     [  6.90000000e+02   5.15623400e+00]
     [  6.91000000e+02   5.02709100e+00]
     [  6.92000000e+02   4.90024200e+00]
     [  6.93000000e+02   4.77704600e+00]
     [  6.94000000e+02   4.65828800e+00]
     [  6.95000000e+02   4.54701000e+00]
     [  6.96000000e+02   4.44356000e+00]
     [  6.97000000e+02   4.34772200e+00]
     [  6.98000000e+02   4.25215900e+00]
     [  6.99000000e+02   4.15264300e+00]
     [  7.00000000e+02   4.05390600e+00]
     [  7.01000000e+02   3.96185300e+00]
     [  7.02000000e+02   3.86506100e+00]
     [  7.03000000e+02   3.75530200e+00]
     [  7.04000000e+02   3.63486100e+00]
     [  7.05000000e+02   3.51936000e+00]
     [  7.06000000e+02   3.41880300e+00]
     [  7.07000000e+02   3.32857100e+00]
     [  7.08000000e+02   3.24645800e+00]
     [  7.09000000e+02   3.16022500e+00]
     [  7.10000000e+02   3.06638600e+00]
     [  7.11000000e+02   2.97029000e+00]
     [  7.12000000e+02   2.87809800e+00]
     [  7.13000000e+02   2.79031100e+00]
     [  7.14000000e+02   2.70126500e+00]
     [  7.15000000e+02   2.60764600e+00]
     [  7.16000000e+02   2.51549000e+00]
     [  7.17000000e+02   2.43531300e+00]
     [  7.18000000e+02   2.36150500e+00]
     [  7.19000000e+02   2.28227100e+00]
     [  7.20000000e+02   2.19250000e+00]
     [  7.21000000e+02   2.10159400e+00]
     [  7.22000000e+02   2.02735600e+00]
     [  7.23000000e+02   1.96655300e+00]
     [  7.24000000e+02   1.91294800e+00]
     [  7.25000000e+02   1.85519300e+00]
     [  7.26000000e+02   1.78513800e+00]
     [  7.27000000e+02   1.71066700e+00]
     [  7.28000000e+02   1.63878500e+00]
     [  7.29000000e+02   1.58238500e+00]
     [  7.30000000e+02   1.53922800e+00]
     [  7.31000000e+02   1.49854800e+00]
     [  7.32000000e+02   1.45540700e+00]
     [  7.33000000e+02   1.41303400e+00]
     [  7.34000000e+02   1.37202100e+00]
     [  7.35000000e+02   1.32477200e+00]
     [  7.36000000e+02   1.27715700e+00]
     [  7.37000000e+02   1.23888800e+00]
     [  7.38000000e+02   1.21111300e+00]
     [  7.39000000e+02   1.18254100e+00]
     [  7.40000000e+02   1.14938200e+00]
     [  7.41000000e+02   1.11849000e+00]
     [  7.42000000e+02   1.09120400e+00]
     [  7.43000000e+02   1.06553900e+00]
     [  7.44000000e+02   1.03956400e+00]
     [  7.45000000e+02   1.01314800e+00]
     [  7.46000000e+02   9.90818000e-01]
     [  7.47000000e+02   9.76522000e-01]
     [  7.48000000e+02   9.60074000e-01]
     [  7.49000000e+02   9.35639000e-01]
     [  7.50000000e+02   9.05095000e-01]
     [  7.51000000e+02   8.78893000e-01]
     [  7.52000000e+02   8.62828000e-01]
     [  7.53000000e+02   8.47588000e-01]
     [  7.54000000e+02   8.29938000e-01]
     [  7.55000000e+02   8.08772000e-01]
     [  7.56000000e+02   7.86338000e-01]
     [  7.57000000e+02   7.61752000e-01]
     [  7.58000000e+02   7.35873000e-01]
     [  7.59000000e+02   7.11232000e-01]
     [  7.60000000e+02   6.90947000e-01]
     [  7.61000000e+02   6.73476000e-01]
     [  7.62000000e+02   6.59236000e-01]
     [  7.63000000e+02   6.46735000e-01]
     [  7.64000000e+02   6.33802000e-01]
     [  7.65000000e+02   6.12864000e-01]
     [  7.66000000e+02   5.89102000e-01]
     [  7.67000000e+02   5.67989000e-01]
     [  7.68000000e+02   5.51288000e-01]
     [  7.69000000e+02   5.33479000e-01]
     [  7.70000000e+02   5.08426000e-01]
     [  7.71000000e+02   4.87143000e-01]
     [  7.72000000e+02   4.74126000e-01]
     [  7.73000000e+02   4.65145000e-01]
     [  7.74000000e+02   4.55158000e-01]
     [  7.75000000e+02   4.42994000e-01]
     [  7.76000000e+02   4.29114000e-01]
     [  7.77000000e+02   4.19402000e-01]
     [  7.78000000e+02   4.11766000e-01]
     [  7.79000000e+02   4.11766000e-01]
     [  7.80000000e+02   4.11766000e-01]]
    >>> sd.header.comments # doctest: +SKIP
    {"Model Name": "CV600", "Serial Number": "19J00789",
    "Time": "2021/01/04_23:14:46", "Memo": [], "LUX": 695.154907,
    "fc": 64.605476, "CCT": 5198.0, "Duv": -0.00062, "I-Time": 12000.0,
    "X": 682.470886, "Y": 695.154907, "Z": 631.635071, "x": 0.339663,
    "y": 0.345975, "u'": 0.209915, "v'": 0.481087, "LambdaP": 456.0,
    "LambdaPValue": 18.404581, "CRI": 92.956993, "R1": 91.651062,
    "R2": 93.014732, "R3": 97.032013, "R4": 93.513229, "R5": 92.48259,
    "R6": 91.48687, "R7": 93.016129, "R8": 91.459312, "R9": 77.613075,
    "R10": 86.981613, "R11": 94.841324, "R12": 74.139542, "R13": 91.073837,
    "R14": 97.064323, "R15": 88.615669, "TLCI": 97.495056,
    "TLMF-A": 1.270032, "SSI-A": 44.881924, "Rf": 87.234917, "Rg": 98.510712,
    "IRR": 2.607891}
    >>> sd.write(join(directory, 'sd.spdx')) # doctest: +SKIP
    """

    def __init__(self, path, delimiter='\t', spectra_section='380', **kwargs):
        super(SpectralDistribution_UPRTek, self).__init__(path, **kwargs)

        self._delimiter = '\t'
        self.delimiter = delimiter

        self._spectra_section = '380'
        self.spectra_section = spectra_section

        self._metadata = {}

    @property
    def delimiter(self):
        """
        Getter and setter property for the delimiter.

        Parameters
        ----------
        value : unicode
            Value to set the delimiter with.

        Returns
        -------
        unicode
            Delimiter.
        """

        return self._delimiter

    @delimiter.setter
    def delimiter(self, value):
        """
        Setter for the **self.delimiter** property.
        """

        if value is not None:
            assert is_string(
                value
            ), '"{0}" attribute: "{1}" is not a "string" like object!'.format(
                'delimiter', value)

        self._delimiter = value

    @property
    def spectra_section(self):
        """
        Getter and setter property for the spectral section.

        Parameters
        ----------
        value : unicode
            Value to set the spectral section with.

        Returns
        -------
        unicode
            Spectra section.
        """

        return self._spectra_section

    @spectra_section.setter
    def spectra_section(self, value):
        """
        Setter for the **self.spectra_section** property.
        """

        if value is not None:
            assert is_string(
                value
            ), '"{0}" attribute: "{1}" is not a "string" like object!'.format(
                'spectra_section', value)

        self._spectra_section = value

    @property
    def metadata(self):
        """
        Getter and setter property for the metadata.

        Parameters
        ----------
        value : dict
            Value to set the metadata with.

        Returns
        -------
        unicode
            Metadata.
        """

        return self._metadata

    def read(self):
        """
        Reads and parses the spectral data from a given *UPRTek* CSV file.

        Returns
        -------
        SpectralDistribution_UPRTek spectral data.

        Examples
        --------
        >>> from os.path import dirname, join
        >>> directory = join(dirname(__file__), 'tests', 'resources')
        >>> sd = SpectralDistribution_UPRTek(join(directory, 'uprtek.xls.txt'))
        >>> print(sd.read())
        [[  3.80000000e+02   3.02670000e-02]
         [  3.81000000e+02   3.02670000e-02]
         [  3.82000000e+02   3.02670000e-02]
         [  3.83000000e+02   2.98220000e-02]
         [  3.84000000e+02   2.89780000e-02]
         [  3.85000000e+02   2.86230000e-02]
         [  3.86000000e+02   3.08450000e-02]
         [  3.87000000e+02   3.55960000e-02]
         [  3.88000000e+02   3.92310000e-02]
         [  3.89000000e+02   3.90640000e-02]
         [  3.90000000e+02   3.52230000e-02]
         [  3.91000000e+02   3.15800000e-02]
         [  3.92000000e+02   2.91810000e-02]
         [  3.93000000e+02   2.78080000e-02]
         [  3.94000000e+02   2.62560000e-02]
         [  3.95000000e+02   2.45260000e-02]
         [  3.96000000e+02   2.25570000e-02]
         [  3.97000000e+02   2.04190000e-02]
         [  3.98000000e+02   1.85210000e-02]
         [  3.99000000e+02   1.81490000e-02]
         [  4.00000000e+02   1.93250000e-02]
         [  4.01000000e+02   2.16660000e-02]
         [  4.02000000e+02   2.40450000e-02]
         [  4.03000000e+02   2.64730000e-02]
         [  4.04000000e+02   2.90760000e-02]
         [  4.05000000e+02   3.18400000e-02]
         [  4.06000000e+02   3.38840000e-02]
         [  4.07000000e+02   3.40380000e-02]
         [  4.08000000e+02   3.23020000e-02]
         [  4.09000000e+02   3.03830000e-02]
         [  4.10000000e+02   2.94260000e-02]
         [  4.11000000e+02   2.99790000e-02]
         [  4.12000000e+02   3.26140000e-02]
         [  4.13000000e+02   3.72040000e-02]
         [  4.14000000e+02   4.22790000e-02]
         [  4.15000000e+02   4.60290000e-02]
         [  4.16000000e+02   4.86980000e-02]
         [  4.17000000e+02   5.30640000e-02]
         [  4.18000000e+02   5.95300000e-02]
         [  4.19000000e+02   7.08400000e-02]
         [  4.20000000e+02   8.76780000e-02]
         [  4.21000000e+02   1.10043000e-01]
         [  4.22000000e+02   1.36705000e-01]
         [  4.23000000e+02   1.65180000e-01]
         [  4.24000000e+02   1.99071000e-01]
         [  4.25000000e+02   2.41976000e-01]
         [  4.26000000e+02   2.93837000e-01]
         [  4.27000000e+02   3.59177000e-01]
         [  4.28000000e+02   4.34192000e-01]
         [  4.29000000e+02   5.23828000e-01]
         [  4.30000000e+02   6.32578000e-01]
         [  4.31000000e+02   7.58893000e-01]
         [  4.32000000e+02   9.15528000e-01]
         [  4.33000000e+02   1.09648900e+00]
         [  4.34000000e+02   1.30748700e+00]
         [  4.35000000e+02   1.55712500e+00]
         [  4.36000000e+02   1.83877900e+00]
         [  4.37000000e+02   2.18338200e+00]
         [  4.38000000e+02   2.58625100e+00]
         [  4.39000000e+02   3.05402200e+00]
         [  4.40000000e+02   3.62565900e+00]
         [  4.41000000e+02   4.27953800e+00]
         [  4.42000000e+02   5.05583800e+00]
         [  4.43000000e+02   5.91930100e+00]
         [  4.44000000e+02   6.86992600e+00]
         [  4.45000000e+02   7.94029800e+00]
         [  4.46000000e+02   9.09021900e+00]
         [  4.47000000e+02   1.03366700e+01]
         [  4.48000000e+02   1.16198950e+01]
         [  4.49000000e+02   1.29397390e+01]
         [  4.50000000e+02   1.42069180e+01]
         [  4.51000000e+02   1.53966600e+01]
         [  4.52000000e+02   1.64305360e+01]
         [  4.53000000e+02   1.72673740e+01]
         [  4.54000000e+02   1.79122920e+01]
         [  4.55000000e+02   1.82611850e+01]
         [  4.56000000e+02   1.84045810e+01]
         [  4.57000000e+02   1.82880250e+01]
         [  4.58000000e+02   1.80023020e+01]
         [  4.59000000e+02   1.75703720e+01]
         [  4.60000000e+02   1.70112970e+01]
         [  4.61000000e+02   1.64111370e+01]
         [  4.62000000e+02   1.57794400e+01]
         [  4.63000000e+02   1.51689510e+01]
         [  4.64000000e+02   1.45853640e+01]
         [  4.65000000e+02   1.40578720e+01]
         [  4.66000000e+02   1.35757680e+01]
         [  4.67000000e+02   1.31449530e+01]
         [  4.68000000e+02   1.27373070e+01]
         [  4.69000000e+02   1.23461880e+01]
         [  4.70000000e+02   1.19673130e+01]
         [  4.71000000e+02   1.15903080e+01]
         [  4.72000000e+02   1.12098070e+01]
         [  4.73000000e+02   1.08153720e+01]
         [  4.74000000e+02   1.04067480e+01]
         [  4.75000000e+02   1.00072840e+01]
         [  4.76000000e+02   9.62788600e+00]
         [  4.77000000e+02   9.27928600e+00]
         [  4.78000000e+02   8.95839100e+00]
         [  4.79000000e+02   8.66311500e+00]
         [  4.80000000e+02   8.42736200e+00]
         [  4.81000000e+02   8.23875900e+00]
         [  4.82000000e+02   8.11020000e+00]
         [  4.83000000e+02   8.01104800e+00]
         [  4.84000000e+02   7.93912500e+00]
         [  4.85000000e+02   7.90034300e+00]
         [  4.86000000e+02   7.88070300e+00]
         [  4.87000000e+02   7.88727100e+00]
         [  4.88000000e+02   7.90704700e+00]
         [  4.89000000e+02   7.93989500e+00]
         [  4.90000000e+02   7.97729800e+00]
         [  4.91000000e+02   8.01344300e+00]
         [  4.92000000e+02   8.05675600e+00]
         [  4.93000000e+02   8.11261700e+00]
         [  4.94000000e+02   8.18139800e+00]
         [  4.95000000e+02   8.25614800e+00]
         [  4.96000000e+02   8.33260900e+00]
         [  4.97000000e+02   8.41801400e+00]
         [  4.98000000e+02   8.51314800e+00]
         [  4.99000000e+02   8.61678500e+00]
         [  5.00000000e+02   8.71903600e+00]
         [  5.01000000e+02   8.81777600e+00]
         [  5.02000000e+02   8.91441700e+00]
         [  5.03000000e+02   9.01125500e+00]
         [  5.04000000e+02   9.10525500e+00]
         [  5.05000000e+02   9.19321700e+00]
         [  5.06000000e+02   9.27488900e+00]
         [  5.07000000e+02   9.35075100e+00]
         [  5.08000000e+02   9.42382000e+00]
         [  5.09000000e+02   9.49099200e+00]
         [  5.10000000e+02   9.55321500e+00]
         [  5.11000000e+02   9.60833500e+00]
         [  5.12000000e+02   9.65384100e+00]
         [  5.13000000e+02   9.69134700e+00]
         [  5.14000000e+02   9.72714600e+00]
         [  5.15000000e+02   9.76772200e+00]
         [  5.16000000e+02   9.80906400e+00]
         [  5.17000000e+02   9.84256500e+00]
         [  5.18000000e+02   9.86752700e+00]
         [  5.19000000e+02   9.88721900e+00]
         [  5.20000000e+02   9.90610500e+00]
         [  5.21000000e+02   9.92043300e+00]
         [  5.22000000e+02   9.92930400e+00]
         [  5.23000000e+02   9.93285600e+00]
         [  5.24000000e+02   9.93520400e+00]
         [  5.25000000e+02   9.93799100e+00]
         [  5.26000000e+02   9.93844800e+00]
         [  5.27000000e+02   9.93612700e+00]
         [  5.28000000e+02   9.93019200e+00]
         [  5.29000000e+02   9.92266500e+00]
         [  5.30000000e+02   9.91394400e+00]
         [  5.31000000e+02   9.90577400e+00]
         [  5.32000000e+02   9.89876700e+00]
         [  5.33000000e+02   9.89421900e+00]
         [  5.34000000e+02   9.89147900e+00]
         [  5.35000000e+02   9.88371100e+00]
         [  5.36000000e+02   9.86269300e+00]
         [  5.37000000e+02   9.82916800e+00]
         [  5.38000000e+02   9.79525700e+00]
         [  5.39000000e+02   9.76763300e+00]
         [  5.40000000e+02   9.74738000e+00]
         [  5.41000000e+02   9.72966900e+00]
         [  5.42000000e+02   9.71488600e+00]
         [  5.43000000e+02   9.70135500e+00]
         [  5.44000000e+02   9.68831100e+00]
         [  5.45000000e+02   9.67367000e+00]
         [  5.46000000e+02   9.65702700e+00]
         [  5.47000000e+02   9.63331000e+00]
         [  5.48000000e+02   9.60312700e+00]
         [  5.49000000e+02   9.56782300e+00]
         [  5.50000000e+02   9.53404900e+00]
         [  5.51000000e+02   9.50452600e+00]
         [  5.52000000e+02   9.48417800e+00]
         [  5.53000000e+02   9.47173900e+00]
         [  5.54000000e+02   9.45596900e+00]
         [  5.55000000e+02   9.42955700e+00]
         [  5.56000000e+02   9.39645000e+00]
         [  5.57000000e+02   9.36884800e+00]
         [  5.58000000e+02   9.34483200e+00]
         [  5.59000000e+02   9.31394200e+00]
         [  5.60000000e+02   9.27392200e+00]
         [  5.61000000e+02   9.24076700e+00]
         [  5.62000000e+02   9.22098700e+00]
         [  5.63000000e+02   9.21074900e+00]
         [  5.64000000e+02   9.19580000e+00]
         [  5.65000000e+02   9.17339200e+00]
         [  5.66000000e+02   9.14390600e+00]
         [  5.67000000e+02   9.10971000e+00]
         [  5.68000000e+02   9.07823200e+00]
         [  5.69000000e+02   9.05259300e+00]
         [  5.70000000e+02   9.02323400e+00]
         [  5.71000000e+02   8.98489500e+00]
         [  5.72000000e+02   8.95066300e+00]
         [  5.73000000e+02   8.93517900e+00]
         [  5.74000000e+02   8.93630500e+00]
         [  5.75000000e+02   8.93727200e+00]
         [  5.76000000e+02   8.93167100e+00]
         [  5.77000000e+02   8.92145100e+00]
         [  5.78000000e+02   8.91028900e+00]
         [  5.79000000e+02   8.90861900e+00]
         [  5.80000000e+02   8.91788800e+00]
         [  5.81000000e+02   8.93453000e+00]
         [  5.82000000e+02   8.94678400e+00]
         [  5.83000000e+02   8.95876400e+00]
         [  5.84000000e+02   8.97933400e+00]
         [  5.85000000e+02   9.00791300e+00]
         [  5.86000000e+02   9.03354300e+00]
         [  5.87000000e+02   9.05111300e+00]
         [  5.88000000e+02   9.06784200e+00]
         [  5.89000000e+02   9.08989900e+00]
         [  5.90000000e+02   9.11454600e+00]
         [  5.91000000e+02   9.13610600e+00]
         [  5.92000000e+02   9.16427000e+00]
         [  5.93000000e+02   9.20753600e+00]
         [  5.94000000e+02   9.26421100e+00]
         [  5.95000000e+02   9.32152800e+00]
         [  5.96000000e+02   9.37177800e+00]
         [  5.97000000e+02   9.41120900e+00]
         [  5.98000000e+02   9.44372900e+00]
         [  5.99000000e+02   9.49062300e+00]
         [  6.00000000e+02   9.55787100e+00]
         [  6.01000000e+02   9.62675200e+00]
         [  6.02000000e+02   9.67483200e+00]
         [  6.03000000e+02   9.70585600e+00]
         [  6.04000000e+02   9.73942900e+00]
         [  6.05000000e+02   9.78406200e+00]
         [  6.06000000e+02   9.84126800e+00]
         [  6.07000000e+02   9.90708400e+00]
         [  6.08000000e+02   9.97184500e+00]
         [  6.09000000e+02   1.00268230e+01]
         [  6.10000000e+02   1.00600760e+01]
         [  6.11000000e+02   1.00769030e+01]
         [  6.12000000e+02   1.01059140e+01]
         [  6.13000000e+02   1.01612870e+01]
         [  6.14000000e+02   1.02301080e+01]
         [  6.15000000e+02   1.02859820e+01]
         [  6.16000000e+02   1.03365980e+01]
         [  6.17000000e+02   1.03960160e+01]
         [  6.18000000e+02   1.04490150e+01]
         [  6.19000000e+02   1.04782960e+01]
         [  6.20000000e+02   1.04846200e+01]
         [  6.21000000e+02   1.04875370e+01]
         [  6.22000000e+02   1.04989960e+01]
         [  6.23000000e+02   1.05195720e+01]
         [  6.24000000e+02   1.05414950e+01]
         [  6.25000000e+02   1.05498630e+01]
         [  6.26000000e+02   1.05432880e+01]
         [  6.27000000e+02   1.05382410e+01]
         [  6.28000000e+02   1.05468650e+01]
         [  6.29000000e+02   1.05606870e+01]
         [  6.30000000e+02   1.05679540e+01]
         [  6.31000000e+02   1.05643690e+01]
         [  6.32000000e+02   1.05559190e+01]
         [  6.33000000e+02   1.05420540e+01]
         [  6.34000000e+02   1.05274170e+01]
         [  6.35000000e+02   1.05133320e+01]
         [  6.36000000e+02   1.05006410e+01]
         [  6.37000000e+02   1.04933410e+01]
         [  6.38000000e+02   1.04917140e+01]
         [  6.39000000e+02   1.04770330e+01]
         [  6.40000000e+02   1.04359870e+01]
         [  6.41000000e+02   1.03749220e+01]
         [  6.42000000e+02   1.03174160e+01]
         [  6.43000000e+02   1.02695830e+01]
         [  6.44000000e+02   1.02209370e+01]
         [  6.45000000e+02   1.01680040e+01]
         [  6.46000000e+02   1.01157190e+01]
         [  6.47000000e+02   1.00617400e+01]
         [  6.48000000e+02   9.99849200e+00]
         [  6.49000000e+02   9.91903000e+00]
         [  6.50000000e+02   9.82122300e+00]
         [  6.51000000e+02   9.71680000e+00]
         [  6.52000000e+02   9.61991500e+00]
         [  6.53000000e+02   9.53160200e+00]
         [  6.54000000e+02   9.43576900e+00]
         [  6.55000000e+02   9.32664400e+00]
         [  6.56000000e+02   9.21594000e+00]
         [  6.57000000e+02   9.11138400e+00]
         [  6.58000000e+02   9.00510200e+00]
         [  6.59000000e+02   8.89204600e+00]
         [  6.60000000e+02   8.77578300e+00]
         [  6.61000000e+02   8.65911800e+00]
         [  6.62000000e+02   8.53783500e+00]
         [  6.63000000e+02   8.41346900e+00]
         [  6.64000000e+02   8.29258700e+00]
         [  6.65000000e+02   8.17584900e+00]
         [  6.66000000e+02   8.05560600e+00]
         [  6.67000000e+02   7.93136900e+00]
         [  6.68000000e+02   7.81247900e+00]
         [  6.69000000e+02   7.69550500e+00]
         [  6.70000000e+02   7.56471800e+00]
         [  6.71000000e+02   7.42219500e+00]
         [  6.72000000e+02   7.28637500e+00]
         [  6.73000000e+02   7.16608700e+00]
         [  6.74000000e+02   7.05015900e+00]
         [  6.75000000e+02   6.92560900e+00]
         [  6.76000000e+02   6.79267500e+00]
         [  6.77000000e+02   6.65994600e+00]
         [  6.78000000e+02   6.53433300e+00]
         [  6.79000000e+02   6.41604400e+00]
         [  6.80000000e+02   6.29808600e+00]
         [  6.81000000e+02   6.18229600e+00]
         [  6.82000000e+02   6.07310500e+00]
         [  6.83000000e+02   5.96593300e+00]
         [  6.84000000e+02   5.85368200e+00]
         [  6.85000000e+02   5.72993100e+00]
         [  6.86000000e+02   5.59987700e+00]
         [  6.87000000e+02   5.48067000e+00]
         [  6.88000000e+02   5.37621300e+00]
         [  6.89000000e+02   5.27322100e+00]
         [  6.90000000e+02   5.15623400e+00]
         [  6.91000000e+02   5.02709100e+00]
         [  6.92000000e+02   4.90024200e+00]
         [  6.93000000e+02   4.77704600e+00]
         [  6.94000000e+02   4.65828800e+00]
         [  6.95000000e+02   4.54701000e+00]
         [  6.96000000e+02   4.44356000e+00]
         [  6.97000000e+02   4.34772200e+00]
         [  6.98000000e+02   4.25215900e+00]
         [  6.99000000e+02   4.15264300e+00]
         [  7.00000000e+02   4.05390600e+00]
         [  7.01000000e+02   3.96185300e+00]
         [  7.02000000e+02   3.86506100e+00]
         [  7.03000000e+02   3.75530200e+00]
         [  7.04000000e+02   3.63486100e+00]
         [  7.05000000e+02   3.51936000e+00]
         [  7.06000000e+02   3.41880300e+00]
         [  7.07000000e+02   3.32857100e+00]
         [  7.08000000e+02   3.24645800e+00]
         [  7.09000000e+02   3.16022500e+00]
         [  7.10000000e+02   3.06638600e+00]
         [  7.11000000e+02   2.97029000e+00]
         [  7.12000000e+02   2.87809800e+00]
         [  7.13000000e+02   2.79031100e+00]
         [  7.14000000e+02   2.70126500e+00]
         [  7.15000000e+02   2.60764600e+00]
         [  7.16000000e+02   2.51549000e+00]
         [  7.17000000e+02   2.43531300e+00]
         [  7.18000000e+02   2.36150500e+00]
         [  7.19000000e+02   2.28227100e+00]
         [  7.20000000e+02   2.19250000e+00]
         [  7.21000000e+02   2.10159400e+00]
         [  7.22000000e+02   2.02735600e+00]
         [  7.23000000e+02   1.96655300e+00]
         [  7.24000000e+02   1.91294800e+00]
         [  7.25000000e+02   1.85519300e+00]
         [  7.26000000e+02   1.78513800e+00]
         [  7.27000000e+02   1.71066700e+00]
         [  7.28000000e+02   1.63878500e+00]
         [  7.29000000e+02   1.58238500e+00]
         [  7.30000000e+02   1.53922800e+00]
         [  7.31000000e+02   1.49854800e+00]
         [  7.32000000e+02   1.45540700e+00]
         [  7.33000000e+02   1.41303400e+00]
         [  7.34000000e+02   1.37202100e+00]
         [  7.35000000e+02   1.32477200e+00]
         [  7.36000000e+02   1.27715700e+00]
         [  7.37000000e+02   1.23888800e+00]
         [  7.38000000e+02   1.21111300e+00]
         [  7.39000000e+02   1.18254100e+00]
         [  7.40000000e+02   1.14938200e+00]
         [  7.41000000e+02   1.11849000e+00]
         [  7.42000000e+02   1.09120400e+00]
         [  7.43000000e+02   1.06553900e+00]
         [  7.44000000e+02   1.03956400e+00]
         [  7.45000000e+02   1.01314800e+00]
         [  7.46000000e+02   9.90818000e-01]
         [  7.47000000e+02   9.76522000e-01]
         [  7.48000000e+02   9.60074000e-01]
         [  7.49000000e+02   9.35639000e-01]
         [  7.50000000e+02   9.05095000e-01]
         [  7.51000000e+02   8.78893000e-01]
         [  7.52000000e+02   8.62828000e-01]
         [  7.53000000e+02   8.47588000e-01]
         [  7.54000000e+02   8.29938000e-01]
         [  7.55000000e+02   8.08772000e-01]
         [  7.56000000e+02   7.86338000e-01]
         [  7.57000000e+02   7.61752000e-01]
         [  7.58000000e+02   7.35873000e-01]
         [  7.59000000e+02   7.11232000e-01]
         [  7.60000000e+02   6.90947000e-01]
         [  7.61000000e+02   6.73476000e-01]
         [  7.62000000e+02   6.59236000e-01]
         [  7.63000000e+02   6.46735000e-01]
         [  7.64000000e+02   6.33802000e-01]
         [  7.65000000e+02   6.12864000e-01]
         [  7.66000000e+02   5.89102000e-01]
         [  7.67000000e+02   5.67989000e-01]
         [  7.68000000e+02   5.51288000e-01]
         [  7.69000000e+02   5.33479000e-01]
         [  7.70000000e+02   5.08426000e-01]
         [  7.71000000e+02   4.87143000e-01]
         [  7.72000000e+02   4.74126000e-01]
         [  7.73000000e+02   4.65145000e-01]
         [  7.74000000e+02   4.55158000e-01]
         [  7.75000000e+02   4.42994000e-01]
         [  7.76000000e+02   4.29114000e-01]
         [  7.77000000e+02   4.19402000e-01]
         [  7.78000000e+02   4.11766000e-01]
         [  7.79000000e+02   4.11766000e-01]
         [  7.80000000e+02   4.11766000e-01]]
        """

        def as_array(a):
            """
            Inputs list of numbers and converts each element to
            float data type.
            """
            return [float(e) for e in a]

        spectral_sections = defaultdict(list)
        with open(self.path, encoding='utf-8') as csv_file:
            content = csv.reader(csv_file, delimiter=self._delimiter)

            spectral_section = 0
            for row in content:
                if not ''.join(row).strip():
                    continue

                key, value = row[0], row[1:]
                value = value[0] if len(value) == 1 else value

                search = re.search('(\\d{3})\\[?nm\\]?', key)
                if search:
                    wavelength = search.group(1)

                    if wavelength == self._spectra_section:
                        spectral_section += 1

                    spectral_sections[spectral_section].append(
                        [wavelength, value])
                else:
                    for method in (int, float, as_array):
                        try:
                            self._metadata[key] = method(value)
                            break
                        except Exception:
                            self._metadata[key] = value

        self.name = os.path.splitext(os.path.basename(self.path))[0]
        spectral_data = as_float_array(spectral_sections[sorted(
            spectral_sections.keys())[-1]])

        self.wavelengths = spectral_data[..., 0]
        self.values = spectral_data[..., 1]

        self.header.comments = json.dumps(self._metadata)

        if self.delimiter == '\t':
            self.header.report_date = self._metadata['Time'][:10]
            self.header.measurement_equipment = self._metadata['Model Name']
            self.header.manufacturer = 'UPRTek'
            self.spectral_quantity = 'Irradiance'

        if self.delimiter == ',':
            self.header.report_date = self._metadata['Date Saved'][:10]
            self.header.manufacturer = 'Sekonic'
            self.spectral_quantity = 'Irradiance'

        return self


class SpectralDistribution_Sekonic(SpectralDistribution_UPRTek):
    """
    This class serves as a parser to read and write *IES TM-27-14*
    spectral data XML file from a *Sekonic* CSV file.

    Parameters
    ----------
    path : unicode
        Path for Sekonic CSV file.

    Methods
    -------
    -   :meth:`~colour.SpectralDistribution_Sekonic.__init__`
    -   :meth:`~colour.SpectralDistribution_Sekonic.read`
    -   :meth:`~colour.SpectralDistribution_Sekonic.write`

    Examples
    --------
    >>> from os.path import dirname, join
    >>> directory = join(dirname(__file__), 'tests', 'resources')
    >>> sd = SpectralDistribution_Sekonic(join(directory, 'sekonic.csv.txt'))
    >>> print(sd.read())
    [[  3.80000000e+02   0.00000000e+00]
     [  3.81000000e+02   0.00000000e+00]
     [  3.82000000e+02   0.00000000e+00]
     [  3.83000000e+02   0.00000000e+00]
     [  3.84000000e+02   0.00000000e+00]
     [  3.85000000e+02   0.00000000e+00]
     [  3.86000000e+02   0.00000000e+00]
     [  3.87000000e+02   0.00000000e+00]
     [  3.88000000e+02   0.00000000e+00]
     [  3.89000000e+02   0.00000000e+00]
     [  3.90000000e+02   0.00000000e+00]
     [  3.91000000e+02   0.00000000e+00]
     [  3.92000000e+02   2.92785300e-06]
     [  3.93000000e+02   6.50205300e-06]
     [  3.94000000e+02   9.26527500e-06]
     [  3.95000000e+02   1.10320380e-05]
     [  3.96000000e+02   1.19537310e-05]
     [  3.97000000e+02   1.22795550e-05]
     [  3.98000000e+02   1.22587560e-05]
     [  3.99000000e+02   1.21121810e-05]
     [  4.00000000e+02   1.19813650e-05]
     [  4.01000000e+02   1.19951590e-05]
     [  4.02000000e+02   1.22811440e-05]
     [  4.03000000e+02   1.28808280e-05]
     [  4.04000000e+02   1.36973490e-05]
     [  4.05000000e+02   1.46214350e-05]
     [  4.06000000e+02   1.55475080e-05]
     [  4.07000000e+02   1.64549180e-05]
     [  4.08000000e+02   1.74079520e-05]
     [  4.09000000e+02   1.84745880e-05]
     [  4.10000000e+02   1.97110530e-05]
     [  4.11000000e+02   2.10485360e-05]
     [  4.12000000e+02   2.23399670e-05]
     [  4.13000000e+02   2.34369020e-05]
     [  4.14000000e+02   2.42260940e-05]
     [  4.15000000e+02   2.48065550e-05]
     [  4.16000000e+02   2.53546240e-05]
     [  4.17000000e+02   2.60466880e-05]
     [  4.18000000e+02   2.70271340e-05]
     [  4.19000000e+02   2.83301320e-05]
     [  4.20000000e+02   2.99661440e-05]
     [  4.21000000e+02   3.19456450e-05]
     [  4.22000000e+02   3.42672650e-05]
     [  4.23000000e+02   3.69045590e-05]
     [  4.24000000e+02   3.98283740e-05]
     [  4.25000000e+02   4.30101860e-05]
     [  4.26000000e+02   4.64532750e-05]
     [  4.27000000e+02   5.02003900e-05]
     [  4.28000000e+02   5.42963060e-05]
     [  4.29000000e+02   5.87923500e-05]
     [  4.30000000e+02   6.38192720e-05]
     [  4.31000000e+02   6.95697380e-05]
     [  4.32000000e+02   7.62388010e-05]
     [  4.33000000e+02   8.40020510e-05]
     [  4.34000000e+02   9.28996160e-05]
     [  4.35000000e+02   1.02907434e-04]
     [  4.36000000e+02   1.14000723e-04]
     [  4.37000000e+02   1.26147745e-04]
     [  4.38000000e+02   1.39350668e-04]
     [  4.39000000e+02   1.53605943e-04]
     [  4.40000000e+02   1.68909683e-04]
     [  4.41000000e+02   1.85196404e-04]
     [  4.42000000e+02   2.02212090e-04]
     [  4.43000000e+02   2.19666821e-04]
     [  4.44000000e+02   2.37270768e-04]
     [  4.45000000e+02   2.54752871e-04]
     [  4.46000000e+02   2.71882804e-04]
     [  4.47000000e+02   2.88435520e-04]
     [  4.48000000e+02   3.04183195e-04]
     [  4.49000000e+02   3.18816456e-04]
     [  4.50000000e+02   3.31902935e-04]
     [  4.51000000e+02   3.42996238e-04]
     [  4.52000000e+02   3.51659779e-04]
     [  4.53000000e+02   3.57679965e-04]
     [  4.54000000e+02   3.61089711e-04]
     [  4.55000000e+02   3.61937127e-04]
     [  4.56000000e+02   3.60277918e-04]
     [  4.57000000e+02   3.56289936e-04]
     [  4.58000000e+02   3.50250222e-04]
     [  4.59000000e+02   3.42438580e-04]
     [  4.60000000e+02   3.33143020e-04]
     [  4.61000000e+02   3.22732056e-04]
     [  4.62000000e+02   3.11622134e-04]
     [  4.63000000e+02   3.00230284e-04]
     [  4.64000000e+02   2.88942829e-04]
     [  4.65000000e+02   2.77946005e-04]
     [  4.66000000e+02   2.67342635e-04]
     [  4.67000000e+02   2.57235020e-04]
     [  4.68000000e+02   2.47702759e-04]
     [  4.69000000e+02   2.38719338e-04]
     [  4.70000000e+02   2.30227481e-04]
     [  4.71000000e+02   2.22169925e-04]
     [  4.72000000e+02   2.14497733e-04]
     [  4.73000000e+02   2.07189034e-04]
     [  4.74000000e+02   2.00227427e-04]
     [  4.75000000e+02   1.93596818e-04]
     [  4.76000000e+02   1.87307058e-04]
     [  4.77000000e+02   1.81425072e-04]
     [  4.78000000e+02   1.76026821e-04]
     [  4.79000000e+02   1.71187712e-04]
     [  4.80000000e+02   1.66981976e-04]
     [  4.81000000e+02   1.63483521e-04]
     [  4.82000000e+02   1.60765063e-04]
     [  4.83000000e+02   1.58896932e-04]
     [  4.84000000e+02   1.57875169e-04]
     [  4.85000000e+02   1.57608956e-04]
     [  4.86000000e+02   1.58002527e-04]
     [  4.87000000e+02   1.58960844e-04]
     [  4.88000000e+02   1.60401178e-04]
     [  4.89000000e+02   1.62251439e-04]
     [  4.90000000e+02   1.64439844e-04]
     [  4.91000000e+02   1.66898695e-04]
     [  4.92000000e+02   1.69602441e-04]
     [  4.93000000e+02   1.72551969e-04]
     [  4.94000000e+02   1.75748704e-04]
     [  4.95000000e+02   1.79197523e-04]
     [  4.96000000e+02   1.82933160e-04]
     [  4.97000000e+02   1.87002632e-04]
     [  4.98000000e+02   1.91452826e-04]
     [  4.99000000e+02   1.96314068e-04]
     [  5.00000000e+02   2.01534538e-04]
     [  5.01000000e+02   2.07037185e-04]
     [  5.02000000e+02   2.12744897e-04]
     [  5.03000000e+02   2.18581801e-04]
     [  5.04000000e+02   2.24477379e-04]
     [  5.05000000e+02   2.30361940e-04]
     [  5.06000000e+02   2.36165870e-04]
     [  5.07000000e+02   2.41834379e-04]
     [  5.08000000e+02   2.47346645e-04]
     [  5.09000000e+02   2.52687139e-04]
     [  5.10000000e+02   2.57840526e-04]
     [  5.11000000e+02   2.62814428e-04]
     [  5.12000000e+02   2.67655065e-04]
     [  5.13000000e+02   2.72412435e-04]
     [  5.14000000e+02   2.77135783e-04]
     [  5.15000000e+02   2.81845685e-04]
     [  5.16000000e+02   2.86527647e-04]
     [  5.17000000e+02   2.91164964e-04]
     [  5.18000000e+02   2.95740523e-04]
     [  5.19000000e+02   3.00232059e-04]
     [  5.20000000e+02   3.04612651e-04]
     [  5.21000000e+02   3.08855029e-04]
     [  5.22000000e+02   3.12933233e-04]
     [  5.23000000e+02   3.16833000e-04]
     [  5.24000000e+02   3.20547697e-04]
     [  5.25000000e+02   3.24070978e-04]
     [  5.26000000e+02   3.27409187e-04]
     [  5.27000000e+02   3.30665527e-04]
     [  5.28000000e+02   3.33987991e-04]
     [  5.29000000e+02   3.37524747e-04]
     [  5.30000000e+02   3.41368344e-04]
     [  5.31000000e+02   3.45327600e-04]
     [  5.32000000e+02   3.49117006e-04]
     [  5.33000000e+02   3.52450879e-04]
     [  5.34000000e+02   3.55126103e-04]
     [  5.35000000e+02   3.57231562e-04]
     [  5.36000000e+02   3.58921068e-04]
     [  5.37000000e+02   3.60348407e-04]
     [  5.38000000e+02   3.61620390e-04]
     [  5.39000000e+02   3.62726772e-04]
     [  5.40000000e+02   3.63639323e-04]
     [  5.41000000e+02   3.64331092e-04]
     [  5.42000000e+02   3.64891835e-04]
     [  5.43000000e+02   3.65620159e-04]
     [  5.44000000e+02   3.66836379e-04]
     [  5.45000000e+02   3.68854904e-04]
     [  5.46000000e+02   3.71746690e-04]
     [  5.47000000e+02   3.75265605e-04]
     [  5.48000000e+02   3.79145116e-04]
     [  5.49000000e+02   3.83122213e-04]
     [  5.50000000e+02   3.87050648e-04]
     [  5.51000000e+02   3.90928035e-04]
     [  5.52000000e+02   3.94761097e-04]
     [  5.53000000e+02   3.98556062e-04]
     [  5.54000000e+02   4.02294856e-04]
     [  5.55000000e+02   4.05925355e-04]
     [  5.56000000e+02   4.09392873e-04]
     [  5.57000000e+02   4.12643829e-04]
     [  5.58000000e+02   4.15688555e-04]
     [  5.59000000e+02   4.18639625e-04]
     [  5.60000000e+02   4.21619130e-04]
     [  5.61000000e+02   4.24748578e-04]
     [  5.62000000e+02   4.28094878e-04]
     [  5.63000000e+02   4.31627472e-04]
     [  5.64000000e+02   4.35305585e-04]
     [  5.65000000e+02   4.39088471e-04]
     [  5.66000000e+02   4.42934950e-04]
     [  5.67000000e+02   4.46803198e-04]
     [  5.68000000e+02   4.50651161e-04]
     [  5.69000000e+02   4.54437046e-04]
     [  5.70000000e+02   4.58150520e-04]
     [  5.71000000e+02   4.61855903e-04]
     [  5.72000000e+02   4.65628196e-04]
     [  5.73000000e+02   4.69542429e-04]
     [  5.74000000e+02   4.73651045e-04]
     [  5.75000000e+02   4.77944268e-04]
     [  5.76000000e+02   4.82402043e-04]
     [  5.77000000e+02   4.87004407e-04]
     [  5.78000000e+02   4.91718296e-04]
     [  5.79000000e+02   4.96469554e-04]
     [  5.80000000e+02   5.01176575e-04]
     [  5.81000000e+02   5.05757635e-04]
     [  5.82000000e+02   5.10152080e-04]
     [  5.83000000e+02   5.14372950e-04]
     [  5.84000000e+02   5.18449873e-04]
     [  5.85000000e+02   5.22412360e-04]
     [  5.86000000e+02   5.26284566e-04]
     [  5.87000000e+02   5.30070101e-04]
     [  5.88000000e+02   5.33766986e-04]
     [  5.89000000e+02   5.37373126e-04]
     [  5.90000000e+02   5.40883630e-04]
     [  5.91000000e+02   5.44285693e-04]
     [  5.92000000e+02   5.47563192e-04]
     [  5.93000000e+02   5.50700177e-04]
     [  5.94000000e+02   5.53691818e-04]
     [  5.95000000e+02   5.56585495e-04]
     [  5.96000000e+02   5.59442851e-04]
     [  5.97000000e+02   5.62325818e-04]
     [  5.98000000e+02   5.65279392e-04]
     [  5.99000000e+02   5.68273535e-04]
     [  6.00000000e+02   5.71256795e-04]
     [  6.01000000e+02   5.74177830e-04]
     [  6.02000000e+02   5.76974649e-04]
     [  6.03000000e+02   5.79536776e-04]
     [  6.04000000e+02   5.81740285e-04]
     [  6.05000000e+02   5.83461253e-04]
     [  6.06000000e+02   5.84599038e-04]
     [  6.07000000e+02   5.85157890e-04]
     [  6.08000000e+02   5.85171976e-04]
     [  6.09000000e+02   5.84675174e-04]
     [  6.10000000e+02   5.83703280e-04]
     [  6.11000000e+02   5.82299544e-04]
     [  6.12000000e+02   5.80509542e-04]
     [  6.13000000e+02   5.78378676e-04]
     [  6.14000000e+02   5.75953862e-04]
     [  6.15000000e+02   5.73287893e-04]
     [  6.16000000e+02   5.70435368e-04]
     [  6.17000000e+02   5.67450887e-04]
     [  6.18000000e+02   5.64369780e-04]
     [  6.19000000e+02   5.61140885e-04]
     [  6.20000000e+02   5.57688472e-04]
     [  6.21000000e+02   5.53937047e-04]
     [  6.22000000e+02   5.49851626e-04]
     [  6.23000000e+02   5.45581162e-04]
     [  6.24000000e+02   5.41326357e-04]
     [  6.25000000e+02   5.37287910e-04]
     [  6.26000000e+02   5.33593295e-04]
     [  6.27000000e+02   5.30039892e-04]
     [  6.28000000e+02   5.26331889e-04]
     [  6.29000000e+02   5.22173534e-04]
     [  6.30000000e+02   5.17328095e-04]
     [  6.31000000e+02   5.11825143e-04]
     [  6.32000000e+02   5.05769160e-04]
     [  6.33000000e+02   4.99264686e-04]
     [  6.34000000e+02   4.92379884e-04]
     [  6.35000000e+02   4.85043478e-04]
     [  6.36000000e+02   4.77139401e-04]
     [  6.37000000e+02   4.68551356e-04]
     [  6.38000000e+02   4.59251489e-04]
     [  6.39000000e+02   4.49585932e-04]
     [  6.40000000e+02   4.39994939e-04]
     [  6.41000000e+02   4.30918619e-04]
     [  6.42000000e+02   4.22663987e-04]
     [  6.43000000e+02   4.15024377e-04]
     [  6.44000000e+02   4.07667656e-04]
     [  6.45000000e+02   4.00261633e-04]
     [  6.46000000e+02   3.92578833e-04]
     [  6.47000000e+02   3.84767627e-04]
     [  6.48000000e+02   3.77058517e-04]
     [  6.49000000e+02   3.69681919e-04]
     [  6.50000000e+02   3.62766819e-04]
     [  6.51000000e+02   3.56107164e-04]
     [  6.52000000e+02   3.49425798e-04]
     [  6.53000000e+02   3.42445448e-04]
     [  6.54000000e+02   3.35026474e-04]
     [  6.55000000e+02   3.27456160e-04]
     [  6.56000000e+02   3.20101273e-04]
     [  6.57000000e+02   3.13328317e-04]
     [  6.58000000e+02   3.07335460e-04]
     [  6.59000000e+02   3.01838503e-04]
     [  6.60000000e+02   2.96465587e-04]
     [  6.61000000e+02   2.90844997e-04]
     [  6.62000000e+02   2.84782291e-04]
     [  6.63000000e+02   2.78556399e-04]
     [  6.64000000e+02   2.72522098e-04]
     [  6.65000000e+02   2.67032796e-04]
     [  6.66000000e+02   2.62254383e-04]
     [  6.67000000e+02   2.57897831e-04]
     [  6.68000000e+02   2.53598962e-04]
     [  6.69000000e+02   2.48999364e-04]
     [  6.70000000e+02   2.43966802e-04]
     [  6.71000000e+02   2.38797031e-04]
     [  6.72000000e+02   2.33855622e-04]
     [  6.73000000e+02   2.29498852e-04]
     [  6.74000000e+02   2.25782627e-04]
     [  6.75000000e+02   2.22411400e-04]
     [  6.76000000e+02   2.19070076e-04]
     [  6.77000000e+02   2.15468172e-04]
     [  6.78000000e+02   2.11623279e-04]
     [  6.79000000e+02   2.07766803e-04]
     [  6.80000000e+02   2.04134776e-04]
     [  6.81000000e+02   2.00916242e-04]
     [  6.82000000e+02   1.97999922e-04]
     [  6.83000000e+02   1.95158325e-04]
     [  6.84000000e+02   1.92163920e-04]
     [  6.85000000e+02   1.88884194e-04]
     [  6.86000000e+02   1.85509256e-04]
     [  6.87000000e+02   1.82299933e-04]
     [  6.88000000e+02   1.79515657e-04]
     [  6.89000000e+02   1.77253518e-04]
     [  6.90000000e+02   1.75304012e-04]
     [  6.91000000e+02   1.73423585e-04]
     [  6.92000000e+02   1.71374879e-04]
     [  6.93000000e+02   1.69089981e-04]
     [  6.94000000e+02   1.66684200e-04]
     [  6.95000000e+02   1.64281839e-04]
     [  6.96000000e+02   1.61995718e-04]
     [  6.97000000e+02   1.59809686e-04]
     [  6.98000000e+02   1.57624905e-04]
     [  6.99000000e+02   1.55341069e-04]
     [  7.00000000e+02   1.52887544e-04]
     [  7.01000000e+02   1.50368738e-04]
     [  7.02000000e+02   1.47950719e-04]
     [  7.03000000e+02   1.45799495e-04]
     [  7.04000000e+02   1.43992351e-04]
     [  7.05000000e+02   1.42327044e-04]
     [  7.06000000e+02   1.40546414e-04]
     [  7.07000000e+02   1.38393327e-04]
     [  7.08000000e+02   1.35762792e-04]
     [  7.09000000e+02   1.32830304e-04]
     [  7.10000000e+02   1.29795619e-04]
     [  7.11000000e+02   1.26856787e-04]
     [  7.12000000e+02   1.24101163e-04]
     [  7.13000000e+02   1.21442732e-04]
     [  7.14000000e+02   1.18780568e-04]
     [  7.15000000e+02   1.16016025e-04]
     [  7.16000000e+02   1.13144888e-04]
     [  7.17000000e+02   1.10295317e-04]
     [  7.18000000e+02   1.07605832e-04]
     [  7.19000000e+02   1.05211519e-04]
     [  7.20000000e+02   1.03122693e-04]
     [  7.21000000e+02   1.01195699e-04]
     [  7.22000000e+02   9.92776330e-05]
     [  7.23000000e+02   9.72216950e-05]
     [  7.24000000e+02   9.50401080e-05]
     [  7.25000000e+02   9.29213490e-05]
     [  7.26000000e+02   9.10636300e-05]
     [  7.27000000e+02   8.96576530e-05]
     [  7.28000000e+02   8.87293500e-05]
     [  7.29000000e+02   8.81441450e-05]
     [  7.30000000e+02   8.77607820e-05]
     [  7.31000000e+02   8.74391260e-05]
     [  7.32000000e+02   8.70657310e-05]
     [  7.33000000e+02   8.65504410e-05]
     [  7.34000000e+02   8.58036000e-05]
     [  7.35000000e+02   8.47414410e-05]
     [  7.36000000e+02   8.33666560e-05]
     [  7.37000000e+02   8.17485780e-05]
     [  7.38000000e+02   7.99582850e-05]
     [  7.39000000e+02   7.80675040e-05]
     [  7.40000000e+02   7.61524130e-05]
     [  7.41000000e+02   7.42925040e-05]
     [  7.42000000e+02   7.25674690e-05]
     [  7.43000000e+02   7.10585740e-05]
     [  7.44000000e+02   6.98741280e-05]
     [  7.45000000e+02   6.91379760e-05]
     [  7.46000000e+02   6.89737860e-05]
     [  7.47000000e+02   6.94596090e-05]
     [  7.48000000e+02   7.02681860e-05]
     [  7.49000000e+02   7.08497540e-05]
     [  7.50000000e+02   7.06516880e-05]
     [  7.51000000e+02   6.91749010e-05]
     [  7.52000000e+02   6.63295000e-05]
     [  7.53000000e+02   6.22211660e-05]
     [  7.54000000e+02   5.69571570e-05]
     [  7.55000000e+02   5.07405060e-05]
     [  7.56000000e+02   4.43989270e-05]
     [  7.57000000e+02   3.90307320e-05]
     [  7.58000000e+02   3.57362080e-05]
     [  7.59000000e+02   3.53607360e-05]
     [  7.60000000e+02   3.72199210e-05]
     [  7.61000000e+02   4.00707870e-05]
     [  7.62000000e+02   4.26698570e-05]
     [  7.63000000e+02   4.39760990e-05]
     [  7.64000000e+02   4.40123770e-05]
     [  7.65000000e+02   4.31489530e-05]
     [  7.66000000e+02   4.17562590e-05]
     [  7.67000000e+02   4.01754550e-05]
     [  7.68000000e+02   3.86214560e-05]
     [  7.69000000e+02   3.72722720e-05]
     [  7.70000000e+02   3.63058860e-05]
     [  7.71000000e+02   3.58660440e-05]
     [  7.72000000e+02   3.59552400e-05]
     [  7.73000000e+02   3.65417400e-05]
     [  7.74000000e+02   3.75939380e-05]
     [  7.75000000e+02   3.89850720e-05]
     [  7.76000000e+02   4.02472140e-05]
     [  7.77000000e+02   4.08428200e-05]
     [  7.78000000e+02   4.02348520e-05]
     [  7.79000000e+02   3.82163050e-05]
     [  7.80000000e+02   3.55755470e-05]]
    >>> sd.header.comments # doctest: +SKIP
    >>> sd.write(join(directory, 'sd.spdx') # doctest: +SKIP
    """

    def __init__(self, path, delimiter=',', spectra_section='380', **kwargs):
        super(SpectralDistribution_Sekonic, self).__init__(
            path, delimiter, spectra_section, **kwargs)
